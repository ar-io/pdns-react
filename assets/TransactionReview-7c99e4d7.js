import{am as p,l as I,at as T,au as k,av as W,e as v,aw as B,j as t,a as P,z as U,a1 as L,b as O,B as M,r as m,ax as b,ay as F,an as H,U as z,I as Y,as as X,az as q}from"./index-7431f6f4.js";import{W as G}from"./WarningCard-7bacc697.js";import{T as $}from"./TransactionCost-95d7189f.js";import{S as J}from"./StepProgressBar-f2efa770.js";import{g as N}from"./transaction-descriptions-bc78b577.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="9272eb25-6f6c-4f57-3b9d-416e4429a822",e._sentryDebugIdIdentifier="sentry-dbid-9272eb25-6f6c-4f57-3b9d-416e4429a822")}catch{}})();async function K({payload:e,workflowName:a,owner:u,arioContract:c,processId:x,dispatch:d,signer:l,ao:g,scheduler:r=B}){let n;try{if(!c)throw new Error("ArIO provider is not defined");if(!l)throw new Error("signer is not defined");switch(d({type:"setSigning",payload:!0}),a){case p.BUY_RECORD:{const{name:i,type:w,years:h}=e;let o=e.processId;o==="atomic"&&(o=await k({state:e.state,signer:W(l),ao:g,scheduler:r}));const y=await c.buyRecord({name:I(i),type:w,years:h,processId:o});e.processId=o,n=y;break}case p.EXTEND_LEASE:n=await c.extendLease({name:I(e.name),years:e.years},T);break;case p.INCREASE_UNDERNAMES:n=await c.increaseUndernameLimit({name:I(e.name),increaseCount:e.qty},T);break;default:throw new Error(`Unsupported workflow name: ${a}`)}}catch(i){v.emit("error",i)}finally{d({type:"setSigning",payload:!1})}if(!n)throw new Error("Failed to dispatch ArIO interaction");const s={deployer:u.toString(),processId:x.toString(),id:n.id,type:"interaction",payload:e};return d({type:"setWorkflowName",payload:a}),d({type:"setInteractionResult",payload:s}),s}function R({workflowName:e,...a}){switch(e){case p.INCREASE_UNDERNAMES:case p.EXTEND_LEASE:return t.jsx("h1",{className:"flex white",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case p.BUY_RECORD:return"Review your Purchase";default:return}}function ae(){const e=P(),[{ioTicker:a,arioContract:u,ioProcessId:c,aoNetwork:x,aoClient:d}]=U(),[{walletAddress:l,wallet:g}]=L(),[{workflowName:r,interactionType:n,transactionData:s,interactionResult:i},w]=O(),h=M(),[o,y]=m.useState(),[f,j]=m.useState(b(n)),[E,A]=m.useState(R({workflowName:r})),[S,D]=m.useState(N({workflowName:r,ioTicker:a}));m.useEffect(()=>{if(!s&&!r){e("/");return}y(F({interactionType:n,transactionData:{...s,deployedTransactionId:i==null?void 0:i.id}})),D(N({workflowName:r,ioTicker:a})),j(b(n)),A(R({workflowName:r}))},[s,i,r,n,l]);async function _(){try{if(!(u instanceof q))throw new Error("Wallet must be connected to dispatch transactions.");if(!s||!r)throw new Error("Transaction data is missing");if(!l)throw new Error("Wallet address is missing");await K({arioContract:u,workflowName:r,payload:s,owner:l,processId:c,dispatch:w,signer:g==null?void 0:g.arconnectSigner,ao:d,scheduler:x.SCHEDULER}),e("/transaction/complete")}catch(C){v.emit("error",C)}}return o?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:h?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[f&&f.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"20px",width:"100%"},children:t.jsx(J,{stage:3,stages:f})}):t.jsx(t.Fragment,{}),typeof E=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"50px 0px",borderTop:f!=null&&f.length?"solid 1px var(--text-faded)":""},children:E}):E,t.jsx(z,{...o,bordered:!0,compact:!0}),t.jsx($,{feeWrapperStyle:{alignItems:"center",justifyContent:"center",height:"100%"},fee:{[a]:s==null?void 0:s.interactionPrice},info:S&&t.jsx("div",{children:t.jsx(G,{wrapperStyle:{padding:"10px",fontSize:"14px",alignItems:"center"},customIcon:t.jsx(Y,{width:"20px",fill:"var(--accent)"}),text:S})})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx(X,{onNext:()=>_(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx(H,{loading:!0,message:"Loading transaction data..."})}export{ae as default};
//# sourceMappingURL=TransactionReview-7c99e4d7.js.map
