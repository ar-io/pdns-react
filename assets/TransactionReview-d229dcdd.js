import{aY as h,bq as u,b1 as T,bV as v,bW as L,bX as O,bY as P,bZ as B,b_ as F,b$ as Y,c0 as M,j as t,a as H,aF as G,b3 as X,b4 as $,b as q,aG as z,r as m,c1 as _,c2 as V,br as Z,aN as J,bx as K,c3 as Q,c4 as ee}from"./index-952072bb.js";import{A as te}from"./ANTCard-03c1a399.js";import{W as re}from"./WarningCard-610bc916.js";import{T as se}from"./TransactionCost-f1097e4c.js";import{S as ae}from"./StepProgressBar-060b36a8.js";import{g as j}from"./transaction-descriptions-bf2af085.js";import"./useBreakpoint-b2c53a16.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="823ed15a-3aa1-4be0-3655-2e8c5128b5dd",e._sentryDebugIdIdentifier="sentry-dbid-823ed15a-3aa1-4be0-3655-2e8c5128b5dd")}catch{}})();async function ne({payload:e,workflowName:a,owner:f,arioContract:d,processId:y,dispatch:g,signer:x,ao:S,scheduler:l=M}){var r;let i;const n=setTimeout(()=>{h.emit("network:ao:congested",!0)},1e4);try{if(!d)throw new Error("ArIO provider is not defined");if(!x)throw new Error("signer is not defined");switch(g({type:"setSigning",payload:!0}),a){case u.BUY_RECORD:{const{name:s,type:E,years:I}=e;let o=e.processId;if(o==="atomic"){const c=e.state||L(f.toString(),(r=e.targetId)==null?void 0:r.toString());o=await O({state:c,signer:P(x),ao:S,scheduler:l,luaCodeTxId:B}),await F.init({signer:x,processId:Y}).register({processId:o}).catch(w=>{h.emit("error",new Error(`Failed to register ANT process: ${w}. You may need to manually register the process`))})}const b=await d.buyRecord({name:T(s),type:E,years:I,processId:o});e.processId=o,i=b;break}case u.EXTEND_LEASE:i=await d.extendLease({name:T(e.name),years:e.years},v);break;case u.INCREASE_UNDERNAMES:i=await d.increaseUndernameLimit({name:T(e.name),increaseCount:e.qty},v);break;default:throw new Error(`Unsupported workflow name: ${a}`)}}catch(s){h.emit("error",s)}finally{g({type:"setSigning",payload:!1}),clearTimeout(n)}if(!i)throw new Error("Failed to dispatch ArIO interaction");const p={deployer:f.toString(),processId:y.toString(),id:i.id,type:"interaction",payload:e};return g({type:"setWorkflowName",payload:a}),g({type:"setInteractionResult",payload:p}),p}function D({workflowName:e,...a}){switch(e){case u.INCREASE_UNDERNAMES:case u.EXTEND_LEASE:return t.jsx("h1",{className:"flex white text-[2rem]",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case u.BUY_RECORD:return"Review your Purchase";default:return}}function ge(){var R;const e=H(),[{ioTicker:a,arioContract:f,ioProcessId:d,aoNetwork:y,aoClient:g}]=G(),[{arnsEmitter:x},S]=X(),[{walletAddress:l,wallet:i}]=$(),[{workflowName:n,interactionType:p,transactionData:r,interactionResult:s},E]=q(),I=z(),[o,b]=m.useState(),[c,N]=m.useState(_(p)),[w,C]=m.useState(D({workflowName:n})),[A,k]=m.useState(j({workflowName:n,ioTicker:a}));m.useEffect(()=>{if(!r&&!n){e("/");return}b(V({interactionType:p,transactionData:{...r,deployedTransactionId:s==null?void 0:s.id}})),k(j({workflowName:n,ioTicker:a})),N(_(p)),C(D({workflowName:n}))},[r,s,n,p,l]),m.useEffect(()=>{s!=null&&s.id&&e("/transaction/complete")},[s,e]);async function W(){try{if(!(f instanceof Q))throw new Error("Wallet must be connected to dispatch transactions.");if(!r||!n)throw new Error("Transaction data is missing");if(!l)throw new Error("Wallet address is missing");await ne({arioContract:f,workflowName:n,payload:r,owner:l,processId:d,dispatch:E,signer:i==null?void 0:i.contractSigner,ao:g,scheduler:y.SCHEDULER})}catch(U){h.emit("error",U)}finally{l&&ee({emitter:x,dispatch:S,ioProcessId:d,walletAddress:l})}}return o?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:I?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[c&&c.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"20px",width:"100%"},children:t.jsx(ae,{stage:3,stages:c})}):t.jsx(t.Fragment,{}),typeof w=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"50px 0px",borderTop:c!=null&&c.length?"solid 1px var(--text-faded)":""},children:w}):w,t.jsx(te,{...o,bordered:!0,compact:!0,overrides:{...o.overrides,targetId:(R=r==null?void 0:r.targetId)==null?void 0:R.toString()}}),t.jsx(se,{feeWrapperStyle:{alignItems:"center",justifyContent:"center",height:"100%"},fee:{[a]:r==null?void 0:r.interactionPrice},info:A&&t.jsx("div",{children:t.jsx(re,{wrapperStyle:{padding:"10px",fontSize:"14px",alignItems:"center"},customIcon:t.jsx(J,{width:"20px",fill:"var(--accent)"}),text:A})})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx(K,{onNext:()=>W(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx(Z,{loading:!0,message:"Loading transaction data..."})}export{ge as default};
//# sourceMappingURL=TransactionReview-d229dcdd.js.map
