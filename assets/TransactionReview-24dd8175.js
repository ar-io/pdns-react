import{aZ as h,bs as u,b3 as T,bX as v,bY as L,bZ as O,b_ as P,b$ as B,c0 as F,c1 as M,c2 as Y,j as t,a as H,b1 as X,b5 as $,b6 as z,b as G,aF as Z,r as m,c3 as _,c4 as q,bt as J,aM as K,bz as Q,c5 as V,c6 as ee}from"./index-5a80b799.js";import{A as te}from"./ANTCard-f6659aa1.js";import{W as re}from"./WarningCard-912e35a6.js";import{T as se}from"./TransactionCost-6dc17489.js";import{S as ae}from"./StepProgressBar-1ab8ad87.js";import{g as j}from"./transaction-descriptions-0507e31f.js";import"./useBreakpoint-3bfe6a2a.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="f1bd456d-2dbb-405e-b89a-efe932f3bd82",e._sentryDebugIdIdentifier="sentry-dbid-f1bd456d-2dbb-405e-b89a-efe932f3bd82")}catch{}})();async function ne({payload:e,workflowName:a,owner:p,arioContract:d,processId:b,dispatch:g,signer:x,ao:y,scheduler:l=Y}){var r;let i;const n=setTimeout(()=>{h.emit("network:ao:congested",!0)},1e4);try{if(!d)throw new Error("ArIO provider is not defined");if(!x)throw new Error("signer is not defined");switch(g({type:"setSigning",payload:!0}),a){case u.BUY_RECORD:{const{name:s,type:S,years:E}=e;let o=e.processId;if(o==="atomic"){const c=e.state||L(p.toString(),(r=e.targetId)==null?void 0:r.toString());o=await O({state:c,signer:P(x),ao:y,scheduler:l,luaCodeTxId:B}),await F.init({signer:x,processId:M}).register({processId:o}).catch(w=>{h.emit("error",new Error(`Failed to register ANT process: ${w}. You may need to manually register the process`))})}const I=await d.buyRecord({name:T(s),type:S,years:E,processId:o});e.processId=o,i=I;break}case u.EXTEND_LEASE:i=await d.extendLease({name:T(e.name),years:e.years},v);break;case u.INCREASE_UNDERNAMES:i=await d.increaseUndernameLimit({name:T(e.name),increaseCount:e.qty},v);break;default:throw new Error(`Unsupported workflow name: ${a}`)}}catch(s){h.emit("error",s)}finally{g({type:"setSigning",payload:!1}),clearTimeout(n)}if(!i)throw new Error("Failed to dispatch ArIO interaction");const f={deployer:p.toString(),processId:b.toString(),id:i.id,type:"interaction",payload:e};return g({type:"setWorkflowName",payload:a}),g({type:"setInteractionResult",payload:f}),f}function D({workflowName:e,...a}){switch(e){case u.INCREASE_UNDERNAMES:case u.EXTEND_LEASE:return t.jsx("h1",{className:"flex white text-[2rem]",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case u.BUY_RECORD:return"Review your Purchase";default:return}}function ge(){var R;const e=H(),[{ioTicker:a,arioContract:p,ioProcessId:d,aoNetwork:b,aoClient:g}]=X(),[{arnsEmitter:x},y]=$(),[{walletAddress:l,wallet:i}]=z(),[{workflowName:n,interactionType:f,transactionData:r,interactionResult:s},S]=G(),E=Z(),[o,I]=m.useState(),[c,N]=m.useState(_(f)),[w,C]=m.useState(D({workflowName:n})),[A,k]=m.useState(j({workflowName:n,ioTicker:a}));m.useEffect(()=>{if(!r&&!n){e("/");return}I(q({interactionType:f,transactionData:{...r,deployedTransactionId:s==null?void 0:s.id}})),k(j({workflowName:n,ioTicker:a})),N(_(f)),C(D({workflowName:n}))},[r,s,n,f,l]),m.useEffect(()=>{s!=null&&s.id&&e("/transaction/complete")},[s,e]);async function U(){try{if(!(p instanceof V))throw new Error("Wallet must be connected to dispatch transactions.");if(!r||!n)throw new Error("Transaction data is missing");if(!l)throw new Error("Wallet address is missing");await ne({arioContract:p,workflowName:n,payload:r,owner:l,processId:d,dispatch:S,signer:i==null?void 0:i.contractSigner,ao:g,scheduler:b.SCHEDULER})}catch(W){h.emit("error",W)}finally{l&&ee({emitter:x,dispatch:y,ioProcessId:d,walletAddress:l})}}return o?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:E?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[c&&c.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"20px",width:"100%"},children:t.jsx(ae,{stage:3,stages:c})}):t.jsx(t.Fragment,{}),typeof w=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"50px 0px",borderTop:c!=null&&c.length?"solid 1px var(--text-faded)":""},children:w}):w,t.jsx(te,{...o,bordered:!0,compact:!0,overrides:{...o.overrides,targetId:(R=r==null?void 0:r.targetId)==null?void 0:R.toString()}}),t.jsx(se,{feeWrapperStyle:{alignItems:"center",justifyContent:"center",height:"100%"},fee:{[a]:r==null?void 0:r.interactionPrice},info:A&&t.jsx("div",{children:t.jsx(re,{wrapperStyle:{padding:"10px",fontSize:"14px",alignItems:"center"},customIcon:t.jsx(K,{width:"20px",fill:"var(--accent)"}),text:A})})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx(Q,{onNext:()=>U(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx(J,{loading:!0,message:"Loading transaction data..."})}export{ge as default};
//# sourceMappingURL=TransactionReview-24dd8175.js.map
