import{u as R,m as A,a7 as _,l as C,k as L,r as o,R as k,ah as y,ai as b,X as F,W as M,e as T,aO as O,j as e,P,D as U,aP as B,S as m,al as Y,aQ as $,T as z,am as W,A as X,N as V,ao as q}from"./index-32373b7e.js";import{C as G}from"./Counter-e8829076.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},l=new Error().stack;l&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[l]="d6d01d5d-cac3-4379-394f-eaa3bb7afc16",n._sentryDebugIdIdentifier="sentry-dbid-d6d01d5d-cac3-4379-394f-eaa3bb7afc16")}catch{}})();function J(){const[{arweaveDataProvider:n,ioTicker:l}]=R(),[{walletAddress:p}]=A(),[,u]=_(),w=C(),x=L(),t=w.pathname.split("/").at(-2),[r,v]=o.useState(),[N,f]=o.useState(),[d,S]=o.useState(1),[s,I]=o.useState(0),[i,g]=o.useState(),[h,E]=o.useState(0);o.useEffect(()=>{if(!t){x("/manage/names");return}j(k(t))},[t]),o.useEffect(()=>{if(!r||!r.endTimestamp||!t)return;g(void 0),(async()=>{const a=await n.getPriceForInteraction({interactionName:q.EXTEND_RECORD,payload:{name:t,years:d}}).catch(()=>(T.emit("error",new Error("Unable to get price for extend lease")),-1));g(a)})()},[d,s,r,t]);async function j(c){try{const a=await n.getRecord({domain:c});if(!(a!=null&&a.type))throw new Error(`Unable to get record for ${c}`);if(f(a.type),v(a),!a.endTimestamp){f(y.BUY);return}const D=await n.getTokenBalance(p,b);E(D??0),I(Math.max(0,F-M(a.startTimestamp>a.endTimestamp?a.startTimestamp:a.startTimestamp*1e3,a.endTimestamp*1e3)))}catch(a){T.emit("error",a),await O(2e3),x("/manage/names")}}return!r||!t?e.jsx(P,{loading:!r,message:`Loading info for ${t}`}):!r.endTimestamp||N===y.BUY?e.jsx("div",{className:"page center",children:e.jsx(U,{showClose:!1,cancelText:"Manage",body:e.jsxs("span",{className:"flex flex-column white center",style:{height:"100%"},children:["This domain is permanently registered and its lease cannot be extended.",e.jsx(B,{domain:t})]})})}):e.jsx("div",{className:"page center",children:e.jsxs("div",{className:"flex flex-column",style:{maxWidth:"1000px"},children:[e.jsxs("div",{className:"flex flex-row center",style:{justifyContent:"space-between"},children:[e.jsx("h1",{className:"white",children:"Extend Lease"}),e.jsxs("div",{className:"flex flex-row center white",style:{border:"solid 1px var(--text-faded)",borderRadius:"var(--corner-radius)",gap:"8px",width:"fit-content",padding:"12px"},children:[e.jsx(m,{width:"22px",height:"22px",fill:"var(--text-grey)"}),"Expiring on"," ",Intl.DateTimeFormat("en-US").format(r.endTimestamp*1e3)]})]}),e.jsxs("div",{className:"flex flex-column",style:{width:"100%",height:"100%",background:"var(--card-bg)",borderRadius:"var(--corner-radius)",padding:"30px",boxSizing:"border-box",position:"relative"},children:[s<1?e.jsx("div",{className:"flex flex-column center modal-container",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.5)",borderRadius:"var(--corner-radius)",zIndex:1},children:e.jsxs("div",{className:"flex flex-row center",style:{width:"fit-content",height:"fit-content",borderRadius:"var(--corner-radius)",border:"solid 1px var(--error-red)",background:"#1D1314",padding:"10px",boxSizing:"border-box",color:"var(--error-red)",gap:"10px"},children:[" ",e.jsx(m,{width:"24px",height:"24px",fill:"var(--error-red)"}),e.jsx("span",{className:"center",children:"Maximum lease extension reached"})]})}):e.jsx(e.Fragment,{}),e.jsx(G,{setValue:S,value:d,maxValue:s,minValue:Y,valueName:d>1?"years":"year",valueStyle:{padding:"10px 80px"},detail:e.jsxs("span",{children:["until"," ",Intl.DateTimeFormat("en-US",{month:"long",day:"numeric",year:"numeric"}).format(r.endTimestamp*1e3+d*$)]}),title:e.jsx("span",{className:"white",style:{padding:"0px 10px 10px 10px",fontWeight:"500"},children:`Extension Duration ( up to ${Math.max(1,s)} year${s>1?"s":""} )`})})]}),e.jsx(z,{fee:{[l]:i},ioRequired:!0}),e.jsx(W,{backText:"Cancel",nextText:"Continue",customNextStyle:{background:s<1&&"var(--text-grey)",color:s<1&&"var(--text-white)"},onBack:()=>{x(`/manage/names/${t}`)},onNext:!i||i<0?void 0:s>=1||i<=h?()=>{const c={name:t,years:d,contractTxId:new X(r.contractTxId),qty:i};u({type:"setInteractionType",payload:V.EXTEND_LEASE}),u({type:"setTransactionData",payload:{assetId:b.toString(),functionName:"extendRecord",...c,interactionPrice:i}}),x("/transaction",{state:`/manage/names/${t}/extend`})}:void 0,detail:i&&i>h&&s>0?e.jsxs("div",{className:"flex flex-row center",style:{width:"fit-content",height:"fit-content",borderRadius:"var(--corner-radius)",border:"solid 1px var(--error-red)",background:"#1D1314",padding:"8px",boxSizing:"border-box",color:"var(--error-red)",gap:"10px",whiteSpace:"nowrap",fontSize:"13px"},children:[" ",e.jsx(m,{width:"24px",height:"24px",fill:"var(--error-red)"}),e.jsx("span",{className:"center",children:"Insufficient funds."})]}):e.jsx(e.Fragment,{})})]})})}export{J as default};
//# sourceMappingURL=ExtendLease-e4e51c62.js.map
