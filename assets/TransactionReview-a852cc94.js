import{ap as f,l as y,aw as S,ax as h,ay as j,az as O,e as b,j as t,a as U,B as W,a3 as k,b as B,E as P,r as m,aA as T,aB as L,aq as M,X as F,W as X,av as Y,aC as q}from"./index-5eb2509d.js";import{W as z}from"./WarningCard-a99f13dd.js";import{T as G}from"./TransactionCost-501caca6.js";import{S as H}from"./StepProgressBar-9aed8a38.js";import{g as N}from"./transaction-descriptions-e5b99b9c.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},r=new Error().stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="b0a39154-9909-470e-1e16-dc768f5e75b9",e._sentryDebugIdIdentifier="sentry-dbid-b0a39154-9909-470e-1e16-dc768f5e75b9")}catch{}})();const J="rYRd9foqUVvMScTnX63FuyUOaP5tmlJx5tG1btCx6sg";async function V({payload:e,workflowName:r,owner:p,arioContract:d,processId:u,dispatch:i,signer:s}){let n,a;try{if(!d)throw new Error("ArIO provider is not defined");if(!s)throw new Error("signer is not defined");switch(i({type:"setSigning",payload:!0}),r){case f.BUY_RECORD:{const{name:g,type:w,years:x}=e;let l=e.processId;l==="atomic"&&(l=await j({state:e.state,signer:O(s),luaCodeTxId:J}));const o=await d.buyRecord({name:y(g),type:w,years:x,processId:l});e.processId=l,n=o,a=h.BUY_RECORD;break}case f.EXTEND_LEASE:n=await d.extendLease({name:y(e.name),years:e.years},S),a=h.EXTEND_RECORD;break;case f.INCREASE_UNDERNAMES:n=await d.increaseUndernameLimit({name:y(e.name),increaseCount:e.qty},S),a=h.INCREASE_UNDERNAME_COUNT;break;default:throw new Error(`Unsupported workflow name: ${r}`)}}catch(g){b.emit("error",g)}finally{i({type:"setSigning",payload:!1})}if(!n)throw new Error("Failed to dispatch ArIO interaction");if(!a)throw new Error("Failed to set workflow name");const c={deployer:p.toString(),processId:u.toString(),id:n.id,payload:{...e,function:a},type:"interaction"};return i({type:"setWorkflowName",payload:r}),i({type:"setInteractionResult",payload:c}),c}function R({workflowName:e,...r}){switch(e){case f.INCREASE_UNDERNAMES:case f.EXTEND_LEASE:return t.jsx("h1",{className:"flex white",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case f.BUY_RECORD:return"Review your Purchase";default:return}}function te(){const e=U(),[{ioTicker:r,arioContract:p,ioProcessId:d}]=W(),[{walletAddress:u,wallet:i}]=k(),[{workflowName:s,interactionType:n,transactionData:a,interactionResult:c},g]=B(),w=P(),[x,l]=m.useState(),[o,A]=m.useState(T(n)),[E,_]=m.useState(R({workflowName:s})),[I,C]=m.useState(N({workflowName:s,ioTicker:r}));m.useEffect(()=>{if(!a&&!s){e("/");return}l(L({interactionType:n,transactionData:{...a,deployedTransactionId:c==null?void 0:c.id}})),C(N({workflowName:s,ioTicker:r})),A(T(n)),_(R({workflowName:s}))},[a,c,s,n,u]);async function v(){try{if(!(p instanceof q))throw new Error("Wallet must be connected to dispatch transactions.");if(!a||!s)throw new Error("Transaction data is missing");if(!u)throw new Error("Wallet address is missing");await V({arioContract:p,workflowName:s,payload:a,owner:u,processId:d,dispatch:g,signer:i==null?void 0:i.arconnectSigner}),e("/transaction/complete")}catch(D){b.emit("error",D)}}return x?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:w?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[o&&o.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"20px",width:"100%"},children:t.jsx(H,{stage:3,stages:o})}):t.jsx(t.Fragment,{}),typeof E=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"50px 0px",borderTop:o!=null&&o.length?"solid 1px var(--text-faded)":""},children:E}):E,t.jsx(F,{...x,bordered:!0,compact:!0}),t.jsx(G,{feeWrapperStyle:{alignItems:"center",justifyContent:"center",height:"100%"},fee:{[r]:a==null?void 0:a.interactionPrice},info:I&&t.jsx("div",{children:t.jsx(z,{wrapperStyle:{padding:"10px",fontSize:"14px",alignItems:"center"},customIcon:t.jsx(X,{width:"20px",fill:"var(--accent)"}),text:I})})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx(Y,{onNext:()=>v(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx(M,{loading:!0,message:"Loading transaction data..."})}export{te as default};
//# sourceMappingURL=TransactionReview-a852cc94.js.map
