import{am as g,l as N,at as A,au as B,av as U,aw as P,ax as L,e as T,ay as O,j as t,a as F,z as M,az as Y,a1 as H,b as z,B as G,r as w,aA as b,aB as X,an as $,U as q,I as J,as as K,aC as Q,aD as V}from"./index-345b9bb9.js";import{W as Z}from"./WarningCard-e7c142cc.js";import{T as ee}from"./TransactionCost-8c7fcb91.js";import{S as te}from"./StepProgressBar-c657fb23.js";import{g as v}from"./transaction-descriptions-4e4e62d3.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="0c69dc6f-d8b3-4cd3-7541-8e70f9e54994",e._sentryDebugIdIdentifier="sentry-dbid-0c69dc6f-d8b3-4cd3-7541-8e70f9e54994")}catch{}})();async function ae({payload:e,workflowName:a,owner:u,arioContract:o,processId:x,dispatch:l,signer:m,ao:y,scheduler:c=O}){let n;try{if(!o)throw new Error("ArIO provider is not defined");if(!m)throw new Error("signer is not defined");switch(l({type:"setSigning",payload:!0}),a){case g.BUY_RECORD:{const{name:i,type:r,years:p}=e;let d=e.processId;d==="atomic"&&(d=await B({state:e.state,signer:U(m),ao:y,scheduler:c}),await P.init({signer:m,processId:L}).register({processId:d}).catch(S=>{T.emit("error",new Error(`Failed to register ANT process: ${S}. You may need to manually register the process`))}));const h=await o.buyRecord({name:N(i),type:r,years:p,processId:d});e.processId=d,n=h;break}case g.EXTEND_LEASE:n=await o.extendLease({name:N(e.name),years:e.years},A);break;case g.INCREASE_UNDERNAMES:n=await o.increaseUndernameLimit({name:N(e.name),increaseCount:e.qty},A);break;default:throw new Error(`Unsupported workflow name: ${a}`)}}catch(i){T.emit("error",i)}finally{l({type:"setSigning",payload:!1})}if(!n)throw new Error("Failed to dispatch ArIO interaction");const s={deployer:u.toString(),processId:x.toString(),id:n.id,type:"interaction",payload:e};return l({type:"setWorkflowName",payload:a}),l({type:"setInteractionResult",payload:s}),s}function D({workflowName:e,...a}){switch(e){case g.INCREASE_UNDERNAMES:case g.EXTEND_LEASE:return t.jsx("h1",{className:"flex white",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case g.BUY_RECORD:return"Review your Purchase";default:return}}function ce(){const e=F(),[{ioTicker:a,arioContract:u,ioProcessId:o,aoNetwork:x,aoClient:l}]=M(),[{arnsEmitter:m},y]=Y(),[{walletAddress:c,wallet:n}]=H(),[{workflowName:s,interactionType:i,transactionData:r,interactionResult:p},d]=z(),h=G(),[E,S]=w.useState(),[f,j]=w.useState(b(i)),[I,_]=w.useState(D({workflowName:s})),[R,C]=w.useState(v({workflowName:s,ioTicker:a}));w.useEffect(()=>{if(!r&&!s){e("/");return}S(X({interactionType:i,transactionData:{...r,deployedTransactionId:p==null?void 0:p.id}})),C(v({workflowName:s,ioTicker:a})),j(b(i)),_(D({workflowName:s}))},[r,p,s,i,c]);async function k(){try{if(!(u instanceof Q))throw new Error("Wallet must be connected to dispatch transactions.");if(!r||!s)throw new Error("Transaction data is missing");if(!c)throw new Error("Wallet address is missing");await ae({arioContract:u,workflowName:s,payload:r,owner:c,processId:o,dispatch:d,signer:n==null?void 0:n.arconnectSigner,ao:l,scheduler:x.SCHEDULER}),e("/transaction/complete")}catch(W){T.emit("error",W)}finally{c&&V({emitter:m,dispatch:y,ioProcessId:o,walletAddress:c})}}return E?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:h?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[f&&f.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"20px",width:"100%"},children:t.jsx(te,{stage:3,stages:f})}):t.jsx(t.Fragment,{}),typeof I=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"50px 0px",borderTop:f!=null&&f.length?"solid 1px var(--text-faded)":""},children:I}):I,t.jsx(q,{...E,bordered:!0,compact:!0}),t.jsx(ee,{feeWrapperStyle:{alignItems:"center",justifyContent:"center",height:"100%"},fee:{[a]:r==null?void 0:r.interactionPrice},info:R&&t.jsx("div",{children:t.jsx(Z,{wrapperStyle:{padding:"10px",fontSize:"14px",alignItems:"center"},customIcon:t.jsx(J,{width:"20px",fill:"var(--accent)"}),text:R})})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx(K,{onNext:()=>k(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx($,{loading:!0,message:"Loading transaction data..."})}export{ce as default};
//# sourceMappingURL=TransactionReview-9ffeb86e.js.map
