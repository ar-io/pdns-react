import{an as i,av as x,ai as A,aw as h,ax as j,A as S,ay as B,ak as N,az as U,f as y,aA as L,j as t,a as P,y as W,b as F,c as M,z as Y,r as f,aB as p,aC as X,ao as q,U as H,aD as $}from"./index-c9813144.js";import{S as G}from"./Info-e887babb.js";import{T as z,W as J}from"./WorkflowButtons-531d38a6.js";import{S as K}from"./StepProgressBar-5bf681a8.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="f69bc653-c8a8-46b2-f3e0-d68cabf1b39f",e._sentryDebugIdIdentifier="sentry-dbid-f69bc653-c8a8-46b2-f3e0-d68cabf1b39f")}catch{}})();async function Q({payload:e,workflowName:a,arioContract:c,arweaveCompositeProvider:u,contractTxId:w,dispatch:d}){let n,s;try{if(!c)throw new Error("ArIO provider is not defined");switch(d({type:"setSigning",payload:!0}),a){case i.BUY_RECORD:{let o;e.contractTxId===A?e.targetId&&e.state&&(e.state.records["@"]={transactionId:e.targetId,ttlSeconds:h}):e.targetId&&(o=j({contractId:new S(e.contractTxId),input:{function:"setRecord",subDomain:"@",transactionId:e.targetId,ttlSeconds:h}}));const E=B(i.BUY_RECORD,e);n={id:e.contractTxId===A?await u.registerAtomicName({walletAddress:e.walletAddress,registryId:N,srcCodeTransactionId:new S(U),initialState:e.state,domain:e.name,type:e.type,years:e.years,auction:e.auction??!1,qty:e.qty,isBid:e.isBid??!1}):await u.writeTransaction({walletAddress:e.walletAddress,contractTxId:N,dryWrite:!0,payload:{function:x.BUY_RECORD,...E},tags:o,interactionDetails:{isBid:e.isBid?e.isBid:!1}}),owner:e.walletAddress},s=x.BUY_RECORD;break}case i.EXTEND_LEASE:n=await c.extendLease({domain:e.name,years:e.years}),s=x.EXTEND_RECORD;break;case i.INCREASE_UNDERNAMES:n=await c.increaseUndernameLimit({domain:e.name,qty:e.qty}),s=x.INCREASE_UNDERNAME_COUNT;break;default:throw new Error(`Unsupported workflow name: ${a}`)}}catch(o){y.emit("error",o)}finally{d({type:"setSigning",payload:!1})}if(!n)throw new Error("Failed to dispatch ArIO interaction");if(!s)throw new Error("Failed to set workflow name");const r={deployer:e.walletAddress.toString(),contractTxId:w.toString(),id:await n.id,payload:{...e,function:s},type:"interaction"};return await L.push(w.toString(),r),d({type:"setWorkflowName",payload:a}),d({type:"setInteractionResult",payload:r}),r}function R({workflowName:e,...a}){switch(e){case i.INCREASE_UNDERNAMES:return`Increasing your undernames is paid in ${a.ioTicker} tokens, and an Arweave network fee paid in AR tokens.`;case i.EXTEND_LEASE:case i.BUY_RECORD:return`This includes a registration fee (paid in ${a.ioTicker} tokens) and the Arweave network fee (paid in AR tokens).`;default:return}}function _({workflowName:e,...a}){switch(e){case i.INCREASE_UNDERNAMES:case i.EXTEND_LEASE:return t.jsx("h1",{className:"flex white",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case i.BUY_RECORD:return`Review your ${a.auction?"Auction":"Purchase"}`;default:return}}function ae(){const e=P(),[{ioTicker:a,arioContract:c,arnsContractId:u,arweaveDataProvider:w}]=W(),[{walletAddress:d}]=F(),[{workflowName:n,interactionType:s,transactionData:r,interactionResult:o},E]=M(),m=Y(),[T,D]=f.useState(),[l,C]=f.useState(p(s)),[g,b]=f.useState(_({workflowName:n})),[I,v]=f.useState(R({workflowName:n,ioTicker:a}));f.useEffect(()=>{!r&&!n&&e("/"),D(X({interactionType:s,transactionData:{...r,deployedTransactionId:o==null?void 0:o.id}})),v(R({workflowName:n,ioTicker:a})),C(p(s)),b(_({workflowName:n,auction:{...r}.auction}))},[r,o,n,s,d]);async function k(){try{if(!(c instanceof $))throw new Error("Wallet must be connected to dispatch transactions.");if(!r||!n)throw new Error("Transaction data is missing");await Q({arioContract:c,arweaveCompositeProvider:w,workflowName:n,payload:r,contractTxId:u,dispatch:E}),e("/transaction/complete")}catch(O){y.emit("error",O)}}return T?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:m?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[l&&l.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"30px",width:"100%"},children:t.jsx(K,{stage:3,stages:l})}):t.jsx(t.Fragment,{}),typeof g=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"80px 0px",borderTop:l!=null&&l.length?"solid 1px var(--text-faded)":""},children:g}):g,t.jsx(H,{...T,bordered:!0,compact:!1}),t.jsx(z,{fee:{[a]:r==null?void 0:r.interactionPrice},info:I&&t.jsxs("div",{className:"flex flex-row flex-left",style:{gap:"10px",maxWidth:"50%",justifyContent:"flex-start",alignItems:"flex-start"},children:[t.jsx(G,{width:"20px",height:"20px",fill:"var(--text-grey)"}),t.jsx("span",{className:"flex flex-column flex-left grey text",style:{textAlign:"left",lineHeight:"1.5em"},children:I})]})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx(J,{onNext:()=>k(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx(q,{loading:!0,message:"Loading transaction data..."})}export{ae as default};
//# sourceMappingURL=TransactionReview-56c21d9f.js.map
