import{ao as i,ax as w,aj as h,ay as A,az as B,A as p,aA as O,al as S,aB as U,f as D,aC as L,j as t,a as P,y as W,b as F,c as M,z as Y,r as f,aD as N,aE as X,ap as q,W as H,au as $,aF as G}from"./index-19cb63cd.js";import{S as z}from"./Info-bbfed089.js";import{T as J}from"./TransactionCost-86923ab9.js";import{S as K}from"./StepProgressBar-13809531.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="3c8e5d71-a4f5-4f33-3be0-848e39ff8ba0",e._sentryDebugIdIdentifier="sentry-dbid-3c8e5d71-a4f5-4f33-3be0-848e39ff8ba0")}catch{}})();async function Q({payload:e,workflowName:a,arioContract:c,arweaveCompositeProvider:u,contractTxId:x,dispatch:d}){let n,r;try{if(!c)throw new Error("ArIO provider is not defined");switch(d({type:"setSigning",payload:!0}),a){case i.BUY_RECORD:{let o;e.contractTxId===h?e.targetId&&e.state&&(e.state.records["@"]={transactionId:e.targetId,ttlSeconds:A}):e.targetId&&(o=B({contractId:new p(e.contractTxId),input:{function:"setRecord",subDomain:"@",transactionId:e.targetId,ttlSeconds:A}}));const E=O(i.BUY_RECORD,e);n={id:e.contractTxId===h?await u.registerAtomicName({walletAddress:e.walletAddress,registryId:S,srcCodeTransactionId:new p(U),initialState:e.state,domain:e.name,type:e.type,years:e.years,auction:e.auction??!1,qty:e.qty,isBid:e.isBid??!1}):await u.writeTransaction({walletAddress:e.walletAddress,contractTxId:S,dryWrite:!0,payload:{function:w.BUY_RECORD,...E},tags:o,interactionDetails:{isBid:e.isBid?e.isBid:!1}}),owner:e.walletAddress},r=w.BUY_RECORD;break}case i.EXTEND_LEASE:n=await c.extendLease({domain:e.name,years:e.years}),r=w.EXTEND_RECORD;break;case i.INCREASE_UNDERNAMES:n=await c.increaseUndernameLimit({domain:e.name,qty:e.qty}),r=w.INCREASE_UNDERNAME_COUNT;break;default:throw new Error(`Unsupported workflow name: ${a}`)}}catch(o){D.emit("error",o)}finally{d({type:"setSigning",payload:!1})}if(!n)throw new Error("Failed to dispatch ArIO interaction");if(!r)throw new Error("Failed to set workflow name");const s={deployer:e.walletAddress.toString(),contractTxId:x.toString(),id:await n.id,payload:{...e,function:r},type:"interaction"};return await L.push(x.toString(),s),d({type:"setWorkflowName",payload:a}),d({type:"setInteractionResult",payload:s}),s}function R({workflowName:e,...a}){switch(e){case i.INCREASE_UNDERNAMES:return`Increasing your undernames is paid in ${a.ioTicker} tokens, and an Arweave network fee paid in AR tokens.`;case i.EXTEND_LEASE:case i.BUY_RECORD:return`This includes a registration fee (paid in ${a.ioTicker} tokens) and the Arweave network fee (paid in AR tokens).`;default:return}}function y({workflowName:e,...a}){switch(e){case i.INCREASE_UNDERNAMES:case i.EXTEND_LEASE:return t.jsx("h1",{className:"flex white",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case i.BUY_RECORD:return`Review your ${a.auction?"Auction":"Purchase"}`;default:return}}function ae(){const e=P(),[{ioTicker:a,arioContract:c,arnsContractId:u,arweaveDataProvider:x}]=W(),[{walletAddress:d}]=F(),[{workflowName:n,interactionType:r,transactionData:s,interactionResult:o},E]=M(),m=Y(),[T,_]=f.useState(),[l,C]=f.useState(N(r)),[g,v]=f.useState(y({workflowName:n})),[I,b]=f.useState(R({workflowName:n,ioTicker:a}));f.useEffect(()=>{!s&&!n&&e("/"),_(X({interactionType:r,transactionData:{...s,deployedTransactionId:o==null?void 0:o.id}})),b(R({workflowName:n,ioTicker:a})),C(N(r)),v(y({workflowName:n,auction:{...s}.auction}))},[s,o,n,r,d]);async function j(){try{if(!(c instanceof G))throw new Error("Wallet must be connected to dispatch transactions.");if(!s||!n)throw new Error("Transaction data is missing");await Q({arioContract:c,arweaveCompositeProvider:x,workflowName:n,payload:s,contractTxId:u,dispatch:E}),e("/transaction/complete")}catch(k){D.emit("error",k)}}return T?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:m?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[l&&l.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"30px",width:"100%"},children:t.jsx(K,{stage:3,stages:l})}):t.jsx(t.Fragment,{}),typeof g=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"80px 0px",borderTop:l!=null&&l.length?"solid 1px var(--text-faded)":""},children:g}):g,t.jsx(H,{...T,bordered:!0,compact:!1}),t.jsx(J,{fee:{[a]:s==null?void 0:s.interactionPrice},info:I&&t.jsxs("div",{className:"flex flex-row flex-left",style:{gap:"10px",maxWidth:"50%",justifyContent:"flex-start",alignItems:"flex-start"},children:[t.jsx(z,{width:"20px",height:"20px",fill:"var(--text-grey)"}),t.jsx("span",{className:"flex flex-column flex-left grey text",style:{textAlign:"left",lineHeight:"1.5em"},children:I})]})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx($,{onNext:()=>j(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx(q,{loading:!0,message:"Loading transaction data..."})}export{ae as default};
//# sourceMappingURL=TransactionReview-32a90031.js.map
