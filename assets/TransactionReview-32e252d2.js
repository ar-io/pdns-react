import{ao as i,ax as h,ay as w,aj as A,az as S,aA as B,A as p,aB as U,al as N,aC as L,f as _,aD as P,j as t,a as W,y as F,b as M,c as Y,z as X,r as f,aE as R,aF as q,ap as G,W as H,au as $,aG as z}from"./index-7a6bb8c8.js";import{S as J}from"./Info-0a8e408e.js";import{T as K}from"./TransactionCost-1196e164.js";import{S as Q}from"./StepProgressBar-2538469a.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="a9368977-d540-4bff-a119-b812ed8b7665",e._sentryDebugIdIdentifier="sentry-dbid-a9368977-d540-4bff-a119-b812ed8b7665")}catch{}})();async function V({payload:e,workflowName:a,arioContract:c,arweaveCompositeProvider:u,contractTxId:x,dispatch:d}){let n,r;try{if(!c)throw new Error("ArIO provider is not defined");switch(d({type:"setSigning",payload:!0}),a){case i.BUY_RECORD:{let o;e.contractTxId===A?e.targetId&&e.state&&(e.state.records["@"]={transactionId:e.targetId,ttlSeconds:S}):e.targetId&&(o=B({contractId:new p(e.contractTxId),input:{function:"setRecord",subDomain:"@",transactionId:e.targetId,ttlSeconds:S}}));const E=U(i.BUY_RECORD,e);n={id:e.contractTxId===A?await u.registerAtomicName({walletAddress:e.walletAddress,registryId:N,srcCodeTransactionId:new p(L),initialState:e.state,domain:e.name,type:e.type,years:e.years,auction:e.auction??!1,qty:e.qty,isBid:e.isBid??!1}):await u.writeTransaction({walletAddress:e.walletAddress,contractTxId:N,dryWrite:!0,payload:{function:w.BUY_RECORD,...E},tags:o,interactionDetails:{isBid:e.isBid?e.isBid:!1}}),owner:e.walletAddress},r=w.BUY_RECORD;break}case i.EXTEND_LEASE:n=await c.extendLease({domain:e.name,years:e.years},h),r=w.EXTEND_RECORD;break;case i.INCREASE_UNDERNAMES:n=await c.increaseUndernameLimit({domain:e.name,qty:e.qty},h),r=w.INCREASE_UNDERNAME_COUNT;break;default:throw new Error(`Unsupported workflow name: ${a}`)}}catch(o){_.emit("error",o)}finally{d({type:"setSigning",payload:!1})}if(!n)throw new Error("Failed to dispatch ArIO interaction");if(!r)throw new Error("Failed to set workflow name");const s={deployer:e.walletAddress.toString(),contractTxId:x.toString(),id:await n.id,payload:{...e,function:r},type:"interaction"};return await P.push(x.toString(),s),d({type:"setWorkflowName",payload:a}),d({type:"setInteractionResult",payload:s}),s}function y({workflowName:e,...a}){switch(e){case i.INCREASE_UNDERNAMES:return`Increasing your undernames is paid in ${a.ioTicker} tokens, and an Arweave network fee paid in AR tokens.`;case i.EXTEND_LEASE:case i.BUY_RECORD:return`This includes a registration fee (paid in ${a.ioTicker} tokens) and the Arweave network fee (paid in AR tokens).`;default:return}}function D({workflowName:e,...a}){switch(e){case i.INCREASE_UNDERNAMES:case i.EXTEND_LEASE:return t.jsx("h1",{className:"flex white",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case i.BUY_RECORD:return`Review your ${a.auction?"Auction":"Purchase"}`;default:return}}function ne(){const e=W(),[{ioTicker:a,arioContract:c,arnsContractId:u,arweaveDataProvider:x}]=F(),[{walletAddress:d}]=M(),[{workflowName:n,interactionType:r,transactionData:s,interactionResult:o},E]=Y(),m=X(),[T,C]=f.useState(),[l,b]=f.useState(R(r)),[g,v]=f.useState(D({workflowName:n})),[I,j]=f.useState(y({workflowName:n,ioTicker:a}));f.useEffect(()=>{!s&&!n&&e("/"),C(q({interactionType:r,transactionData:{...s,deployedTransactionId:o==null?void 0:o.id}})),j(y({workflowName:n,ioTicker:a})),b(R(r)),v(D({workflowName:n,auction:{...s}.auction}))},[s,o,n,r,d]);async function k(){try{if(!(c instanceof z))throw new Error("Wallet must be connected to dispatch transactions.");if(!s||!n)throw new Error("Transaction data is missing");await V({arioContract:c,arweaveCompositeProvider:x,workflowName:n,payload:s,contractTxId:u,dispatch:E}),e("/transaction/complete")}catch(O){_.emit("error",O)}}return T?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:m?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[l&&l.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"30px",width:"100%"},children:t.jsx(Q,{stage:3,stages:l})}):t.jsx(t.Fragment,{}),typeof g=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"80px 0px",borderTop:l!=null&&l.length?"solid 1px var(--text-faded)":""},children:g}):g,t.jsx(H,{...T,bordered:!0,compact:!1}),t.jsx(K,{fee:{[a]:s==null?void 0:s.interactionPrice},info:I&&t.jsxs("div",{className:"flex flex-row flex-left",style:{gap:"10px",maxWidth:"50%",justifyContent:"flex-start",alignItems:"flex-start"},children:[t.jsx(J,{width:"20px",height:"20px",fill:"var(--text-grey)"}),t.jsx("span",{className:"flex flex-column flex-left grey text",style:{textAlign:"left",lineHeight:"1.5em"},children:I})]})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx($,{onNext:()=>k(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx(G,{loading:!0,message:"Loading transaction data..."})}export{ne as default};
//# sourceMappingURL=TransactionReview-32e252d2.js.map
