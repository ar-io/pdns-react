import{z as j,d as T,a as C,y as A,c as R,r,b0 as U,aa as p,A as D,f as g,bs as _,j as e,U as k,e as M,au as W,al as L,ao as w,aw as O}from"./index-643d848e.js";import{S as P}from"./Info-0dfc3270.js";import{C as V}from"./Counter-a79b54bd.js";import{T as $}from"./TransactionCost-e09dbcfa.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},i=new Error().stack;i&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[i]="3d47136c-db8d-45d3-c74c-7334365f7356",o._sentryDebugIdIdentifier="sentry-dbid-3d47136c-db8d-45d3-c74c-7334365f7356")}catch{}})();function G(){const o=j(),i=T(),c=C(),[{arweaveDataProvider:l,ioTicker:y}]=A(),t=i.pathname.split("/").at(-2),[,x]=R(),[n,b]=r.useState(),[N,E]=r.useState(),[s,S]=r.useState(0),[I,h]=r.useState(!1),[d,f]=r.useState(0);r.useEffect(()=>{v()},[t]),r.useEffect(()=>{if(!t||!n)return;f(void 0),(async()=>{if(s===0){f(0);return}Number.isNaN(s)&&g.emit("error",new Error("Invalid undername count, must be a number greater than 0"));const m=await l.getPriceForInteraction({interactionName:O.INCREASE_UNDERNAME_COUNT,payload:{name:t,qty:s}}).catch(()=>(g.emit("error",new Error("Unable to get price for undername increase")),-1));f(m)})()},[s,n,t]);async function v(){try{if(h(!0),t&&U({name:p(t)})){const a=await l.getRecord({domain:p(t)});if(!a)throw new Error(`Unable to get record for ${t}`);b(a);const m=new D(a==null?void 0:a.contractTxId),u=await l.buildANTContract(m);if(!u.state)throw new Error(`Unable to get contract state for ${t}`);if(!u.isValid)throw new Error(`Invalid contract for ${t}`);E(u)}}catch(a){g.emit("error",a),await _(2e3),c("/manage/names")}finally{h(!1)}}return I||!n||!N||!t?e.jsx("div",{className:"page center",children:e.jsx(k,{size:80,message:"Loading domain record"})}):e.jsx("div",{className:"page center",children:e.jsxs("div",{className:"flex flex-column",style:{maxWidth:"1000px"},children:[e.jsx("h1",{className:"flex white",children:"Increase Undernames"}),e.jsxs("div",{className:"flex center",style:{justifyContent:"space-between",border:"1px solid var(--text-faded)",padding:"35px 40px",borderRadius:"var(--corner-radius)",flexDirection:o?"column":"row",gap:"30px"},children:[e.jsxs("div",{className:"flex flex-column",style:{fontSize:"16px",width:"fit-content",gap:"5px"},children:[e.jsxs("span",{className:"flex grey center",style:{gap:"8px",whiteSpace:"nowrap"},children:["Total Undernames:"," ",e.jsx("span",{className:"white",children:n.undernames}),e.jsxs("span",{className:"flex add-box center",style:{},children:["+",s]})]}),e.jsxs("span",{className:"flex grey",children:["Used:Â ",e.jsx("span",{className:"white",children:Object.keys(N.records).length-1})]})]}),e.jsx(V,{maxValue:M-n.undernames,minValue:0,value:s,setValue:S,containerStyle:{width:"fit-content",justifyContent:"center",alignItems:"center"},valueStyle:{background:"var(--card-bg)",width:"50px",height:"40px",alignItems:"center",justifyContent:"center",border:"1px solid var(--text-faded)",borderRadius:"var(--corner-radius)",margin:"0px 10px",fontSize:"14px"},editable:!0})]}),e.jsx($,{ioRequired:!0,fee:{[y]:d,ar:0},info:e.jsxs("div",{className:"flex flex-row flex-left",style:{gap:"10px",maxWidth:"50%",justifyContent:"flex-start",alignItems:"flex-start"},children:[e.jsx(P,{width:"20px",height:"20px",fill:"var(--text-grey)"}),e.jsxs("span",{className:"flex flex-column flex-left grey text",style:{textAlign:"left",lineHeight:"1.5em"},children:["Increasing your undernames is paid in ",y," tokens, and an Arweave network fee paid in AR tokens."]})]})}),e.jsx(W,{backText:"Cancel",nextText:"Confirm",onBack:()=>c(`/manage/names/${t}`),onNext:!d||d<0?void 0:()=>{const a={name:p(t),qty:s,oldQty:n.undernames,contractTxId:n.contractTxId};x({type:"setTransactionData",payload:{assetId:L.toString(),functionName:"increaseUndernameCount",...a,interactionPrice:d}}),x({type:"setInteractionType",payload:w.INCREASE_UNDERNAMES}),x({type:"setWorkflowName",payload:w.INCREASE_UNDERNAMES}),c("/transaction/review",{state:`/manage/names/${t}/upgrade-undernames`})},customBackStyle:{minWidth:"100px",padding:" 12px 16px"},customNextStyle:{minWidth:"100px",padding:" 12px 16px"}})]})})}export{G as default};
//# sourceMappingURL=UpgradeUndernames-f734f1fb.js.map
