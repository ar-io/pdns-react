import{aU as h,bv as m,bc as T,b_ as A,b$ as W,b4 as L,b1 as P,c0 as B,c1 as O,c2 as F,j as t,a as M,aE as Y,aW as H,aX as X,b as $,aF as G,r as w,c3 as R,c4 as q,bw as z,aM as J,bC as K,c5 as Q,c6 as V}from"./index-f65f9b05.js";import{A as Z}from"./ANTCard-e6bc26ad.js";import{W as ee}from"./WarningCard-ea8cc76a.js";import{T as te}from"./TransactionCost-8a9f53e2.js";import{S as re}from"./StepProgressBar-655dbbba.js";import{g as D}from"./transaction-descriptions-47f4e4b5.js";import"./useBreakpoint-9289f9ef.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},s=new Error().stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="eb3fdd02-27d9-48b1-2536-76674447298e",e._sentryDebugIdIdentifier="sentry-dbid-eb3fdd02-27d9-48b1-2536-76674447298e")}catch{}})();async function se({payload:e,workflowName:s,owner:u,arioContract:o,processId:y,dispatch:p,signer:g,ao:E,scheduler:c=F}){let n;const a=setTimeout(()=>{h.emit("network:ao:congested",!0)},1e4);try{if(!o)throw new Error("ArIO provider is not defined");if(!g)throw new Error("signer is not defined");switch(p({type:"setSigning",payload:!0}),s){case m.BUY_RECORD:{const{name:r,type:f,years:S}=e;let l=e.processId;l==="atomic"&&(l=await W({state:e.state,signer:L(g),ao:E,scheduler:c,luaCodeTxId:P}),await B.init({signer:g,processId:O}).register({processId:l}).catch(i=>{h.emit("error",new Error(`Failed to register ANT process: ${i}. You may need to manually register the process`))}));const x=await o.buyRecord({name:T(r),type:f,years:S,processId:l});e.processId=l,n=x;break}case m.EXTEND_LEASE:n=await o.extendLease({name:T(e.name),years:e.years},A);break;case m.INCREASE_UNDERNAMES:n=await o.increaseUndernameLimit({name:T(e.name),increaseCount:e.qty},A);break;default:throw new Error(`Unsupported workflow name: ${s}`)}}catch(r){h.emit("error",r)}finally{p({type:"setSigning",payload:!1}),clearTimeout(a)}if(!n)throw new Error("Failed to dispatch ArIO interaction");const d={deployer:u.toString(),processId:y.toString(),id:n.id,type:"interaction",payload:e};return p({type:"setWorkflowName",payload:s}),p({type:"setInteractionResult",payload:d}),d}function _({workflowName:e,...s}){switch(e){case m.INCREASE_UNDERNAMES:case m.EXTEND_LEASE:return t.jsx("h1",{className:"flex white",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case m.BUY_RECORD:return"Review your Purchase";default:return}}function pe(){const e=M(),[{ioTicker:s,arioContract:u,ioProcessId:o,aoNetwork:y,aoClient:p}]=Y(),[{arnsEmitter:g},E]=H(),[{walletAddress:c,wallet:n}]=X(),[{workflowName:a,interactionType:d,transactionData:r,interactionResult:f},S]=$(),l=G(),[x,b]=w.useState(),[i,v]=w.useState(R(d)),[I,j]=w.useState(_({workflowName:a})),[N,C]=w.useState(D({workflowName:a,ioTicker:s}));w.useEffect(()=>{if(!r&&!a){e("/");return}b(q({interactionType:d,transactionData:{...r,deployedTransactionId:f==null?void 0:f.id}})),C(D({workflowName:a,ioTicker:s})),v(R(d)),j(_({workflowName:a}))},[r,f,a,d,c]);async function k(){try{if(!(u instanceof Q))throw new Error("Wallet must be connected to dispatch transactions.");if(!r||!a)throw new Error("Transaction data is missing");if(!c)throw new Error("Wallet address is missing");await se({arioContract:u,workflowName:a,payload:r,owner:c,processId:o,dispatch:S,signer:n==null?void 0:n.arconnectSigner,ao:p,scheduler:y.SCHEDULER}),e("/transaction/complete")}catch(U){h.emit("error",U)}finally{c&&V({emitter:g,dispatch:E,ioProcessId:o,walletAddress:c})}}return x?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:l?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[i&&i.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"20px",width:"100%"},children:t.jsx(re,{stage:3,stages:i})}):t.jsx(t.Fragment,{}),typeof I=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"50px 0px",borderTop:i!=null&&i.length?"solid 1px var(--text-faded)":""},children:I}):I,t.jsx(Z,{...x,bordered:!0,compact:!0}),t.jsx(te,{feeWrapperStyle:{alignItems:"center",justifyContent:"center",height:"100%"},fee:{[s]:r==null?void 0:r.interactionPrice},info:N&&t.jsx("div",{children:t.jsx(ee,{wrapperStyle:{padding:"10px",fontSize:"14px",alignItems:"center"},customIcon:t.jsx(J,{width:"20px",fill:"var(--accent)"}),text:N})})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx(K,{onNext:()=>k(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx(z,{loading:!0,message:"Loading transaction data..."})}export{pe as default};
//# sourceMappingURL=TransactionReview-71d927e5.js.map
