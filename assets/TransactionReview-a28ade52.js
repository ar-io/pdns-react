import{an as i,l as h,at as I,au as y,av as j,f as b,j as t,a as k,B as O,b as U,c as B,E as P,r as m,aw as S,ax as W,ao as L,Y as M,as as Y,ay as X}from"./index-096d11db.js";import{S as F}from"./Info-b49eeedf.js";import{T as H}from"./TransactionCost-4383732a.js";import{S as $}from"./StepProgressBar-3ced6c5f.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},s=new Error().stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="3b29f96b-9ddb-4e0a-9f46-427d054c994f",e._sentryDebugIdIdentifier="sentry-dbid-3b29f96b-9ddb-4e0a-9f46-427d054c994f")}catch{}})();const q="rYRd9foqUVvMScTnX63FuyUOaP5tmlJx5tG1btCx6sg";async function G({payload:e,workflowName:s,owner:u,arioContract:l,processId:x,dispatch:o,signer:r}){let n,a;try{if(!l)throw new Error("ArIO provider is not defined");if(!r)throw new Error("signer is not defined");switch(o({type:"setSigning",payload:!0}),s){case i.BUY_RECORD:{const{name:p,type:E,years:g}=e;let f=e.processId;f==="atomic"&&(f=await j({state:e.state,signer:r,luaCodeTxId:q}));const c=await l.buyRecord({name:h(p),type:E,years:g,processId:f});e.processId=f,n=c,a=y.BUY_RECORD;break}case i.EXTEND_LEASE:n=await l.extendLease({name:h(e.name),years:e.years},I),a=y.EXTEND_RECORD;break;case i.INCREASE_UNDERNAMES:n=await l.increaseUndernameLimit({name:h(e.name),increaseCount:e.qty},I),a=y.INCREASE_UNDERNAME_COUNT;break;default:throw new Error(`Unsupported workflow name: ${s}`)}}catch(p){b.emit("error",p)}finally{o({type:"setSigning",payload:!1})}if(!n)throw new Error("Failed to dispatch ArIO interaction");if(!a)throw new Error("Failed to set workflow name");const d={deployer:u.toString(),processId:x.toString(),id:n.id,payload:{...e,function:a},type:"interaction"};return o({type:"setWorkflowName",payload:s}),o({type:"setInteractionResult",payload:d}),d}function T({workflowName:e,...s}){switch(e){case i.INCREASE_UNDERNAMES:return`Increasing your undernames is paid in ${s.ioTicker} tokens.`;case i.EXTEND_LEASE:case i.BUY_RECORD:return`This includes a registration fee (paid in ${s.ioTicker} tokens).`;default:return}}function R({workflowName:e,...s}){switch(e){case i.INCREASE_UNDERNAMES:case i.EXTEND_LEASE:return t.jsx("h1",{className:"flex white",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case i.BUY_RECORD:return"Review your Purchase";default:return}}function Q(){const e=k(),[{ioTicker:s,arioContract:u,arnsContractId:l}]=O(),[{walletAddress:x,wallet:o}]=U(),[{workflowName:r,interactionType:n,transactionData:a,interactionResult:d},p]=B(),E=P(),[g,f]=m.useState(),[c,D]=m.useState(S(n)),[w,_]=m.useState(R({workflowName:r})),[N,v]=m.useState(T({workflowName:r,ioTicker:s}));m.useEffect(()=>{if(!a&&!r){e("/");return}f(W({interactionType:n,transactionData:{...a,deployedTransactionId:d==null?void 0:d.id}})),v(T({workflowName:r,ioTicker:s})),D(S(n)),_(R({workflowName:r}))},[a,d,r,n,x]);async function A(){try{if(!(u instanceof X))throw new Error("Wallet must be connected to dispatch transactions.");if(!a||!r)throw new Error("Transaction data is missing");if(!x)throw new Error("Wallet address is missing");await G({arioContract:u,workflowName:r,payload:a,owner:x,processId:l,dispatch:p,signer:o==null?void 0:o.arconnectSigner}),e("/transaction/complete")}catch(C){b.emit("error",C)}}return g?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:E?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[c&&c.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"30px",width:"100%"},children:t.jsx($,{stage:3,stages:c})}):t.jsx(t.Fragment,{}),typeof w=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"80px 0px",borderTop:c!=null&&c.length?"solid 1px var(--text-faded)":""},children:w}):w,t.jsx(M,{...g,bordered:!0,compact:!1}),t.jsx(H,{fee:{[s]:a==null?void 0:a.interactionPrice},info:N&&t.jsxs("div",{className:"flex flex-row flex-left",style:{gap:"10px",maxWidth:"50%",justifyContent:"flex-start",alignItems:"flex-start"},children:[t.jsx(F,{width:"20px",height:"20px",fill:"var(--text-grey)"}),t.jsx("span",{className:"flex flex-column flex-left grey text",style:{textAlign:"left",lineHeight:"1.5em"},children:N})]})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx(Y,{onNext:()=>A(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx(L,{loading:!0,message:"Loading transaction data..."})}export{Q as default};
//# sourceMappingURL=TransactionReview-a28ade52.js.map
