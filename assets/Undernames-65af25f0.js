import{r as n,aL as ne,ct as re,aM as ie,cu as oe,bu as F,cv as H,bg as V,j as e,aP as le,aR as z,cw as ce,aS as W,cx as de,cy as ue,X as me,bc as xe,b6 as G,bt as O,bs as pe,cz as he,bK as fe,d as ge,g as J,c as be,e as we,f as ye,bn as X,cA as $,S as Ne,cB as L,bj as ve,bf as E,cC as Se,b9 as B,ba as K,cp as je,b8 as Y,cD as Ce,aQ as Q,i as Te,cE as Ie,cF as Ee,cG as Re,cH as De,cI as Ae,A as q,bk as Le,cJ as Me,bd as _e,a as ke,u as Oe,b as Ve,cK as Ue,cL as Pe,bv as Fe,cM as He}from"./index-579ddb5c.js";import{W as ze}from"./WarningCard-1c93a279.js";(function(){try{var i=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},o=new Error().stack;o&&(i._sentryDebugIds=i._sentryDebugIds||{},i._sentryDebugIds[o]="29a74243-6692-4952-162b-5553fdb26ddc",i._sentryDebugIdIdentifier="sentry-dbid-29a74243-6692-4952-162b-5553fdb26ddc")}catch{}})();const We=i=>n.createElement("svg",{width:"current",height:"current",viewBox:"0 0 24 24",fill:"current",xmlns:"http://www.w3.org/2000/svg",...i},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21 6.0014H16V4.3314C15.9512 2.9985 14.833 1.95641 13.5 2.0014H10.5C9.16696 1.95642 8.04885 2.9985 8 4.3314V6.0014H3C2.44771 6.0014 2 6.44912 2 7.0014C2 7.55369 2.44771 8.0014 3 8.0014H4V19.0014C4 20.6583 5.34315 22.0014 7 22.0014H17C18.6569 22.0014 20 20.6583 20 19.0014V8.0014H21C21.5523 8.0014 22 7.55369 22 7.0014C22 6.44912 21.5523 6.0014 21 6.0014ZM10 4.33C10 4.17 10.21 4 10.5 4H13.5C13.79 4 14 4.17 14 4.33V6H10V4.33ZM17 20C17.5523 20 18 19.5523 18 19V8H6V19C6 19.5523 6.44771 20 7 20H17ZM9 17C9.55229 17 10 16.5523 10 16V12C10 11.4477 9.55229 11 9 11C8.44771 11 8 11.4477 8 12V16C8 16.5523 8.44771 17 9 17ZM16 16C16 16.5523 15.5523 17 15 17C14.4477 17 14 16.5523 14 16V12C14 11.4477 14.4477 11 15 11C15.5523 11 16 11.4477 16 12V16Z",fill:"current"}));/**
 * @license lucide-react v0.438.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=ne("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function Ge({antId:i,closeModal:o,payloadCallback:r}){const{data:t}=re(),c=ie(),u=n.useRef(null),f=n.useRef(null),g=n.useRef(null),[m,R]=n.useState(""),[S,T]=n.useState(oe.toString()),[p,w]=n.useState(F),[y,N]=n.useState({}),[M,h]=n.useState(H);n.useEffect(()=>{var a;if(t){const v=Object.entries(t).reduce((x,[k,j])=>(j.processId==i.toString()&&(x[k]=j),x),{});I({arnsRecords:v})}(a=g.current)==null||a.focus()},[i.toString(),t]);async function I({arnsRecords:a}){try{N(a);const v=Object.keys(a).length?Math.min(...Object.keys(a).map(x=>x.length)):0;h(H-v)}catch(v){V.emit("error",v)}}function _(){r({subDomain:m,transactionId:S,ttlSeconds:p})}function C(a,v){return Object.keys(v).filter(x=>a.length+x.length>H)}return e.jsx("div",{className:"modal-container",style:c?{padding:"none"}:{},children:e.jsx(le,{title:e.jsx("h2",{className:"white text-xl",children:"Add Undername"}),body:e.jsx("form",{children:e.jsx("div",{className:"flex flex-column",style:{fontSize:"14px",width:"500px"},children:e.jsxs("div",{className:"flex flex-column",style:{paddingBottom:"30px"},children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"grey",children:"Undername:"}),e.jsxs("span",{className:"flex flex-row",style:{position:"relative"},children:[e.jsx(z,{ref:g,inputClassName:"name-token-input white",inputCustomStyle:{paddingLeft:"10px",fontSize:"14px",paddingRight:"80px"},wrapperCustomStyle:{width:"100%",border:"1px solid var(--text-faded)",borderRadius:"var(--corner-radius)"},showValidationIcon:!0,showValidationOutline:!0,showValidationChecklist:!0,validationListStyle:{display:"none"},value:m,setValue:a=>R(a),catchInvalidInput:!1,maxCharLength:M,customPattern:ce,validationPredicates:{[W.UNDERNAME]:{fn:a=>de(a)},"Dashes and Underscores cannot be leading or trailing":{fn:a=>ue(a)}}},"undername"),e.jsxs("span",{className:"flex flex-row grey",style:{position:"absolute",top:"0px",bottom:"0px",right:m.length?"35px":"10px",width:"fit-content"},children:[m.length," / ",M]})]}),C(m,y).length?e.jsx(ze,{text:e.jsxs("span",{children:["This ANT has"," ",e.jsx(me,{title:e.jsx("div",{className:"flex flex-column",style:{padding:"5px",gap:"5px",boxSizing:"border-box"},children:C(m,y).map(a=>e.jsx("span",{children:a},a))}),color:"var(--card-bg)",placement:"top",showArrow:!0,children:e.jsxs("span",{className:"underline bold",children:[C(m,y).length," ","name",C(m,y).length>1?"s":""]})})," ","that will not support this undername as it is over their supported length."]})}):e.jsx(e.Fragment,{})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"grey",children:"Target ID:"}),e.jsx(z,{ref:u,inputClassName:"name-token-input white",inputCustomStyle:{paddingLeft:"10px",fontSize:"14px",paddingRight:"40px"},wrapperCustomStyle:{position:"relative",border:"1px solid var(--text-faded)",borderRadius:"var(--corner-radius)"},showValidationIcon:!0,showValidationOutline:!0,showValidationChecklist:!0,validationListStyle:{display:"none"},maxCharLength:43,value:S,setValue:T,catchInvalidInput:!0,customPattern:xe,validationPredicates:{[W.ARWEAVE_ID]:{fn:async a=>{if(!G(a))throw new Error("Invalid Arweave ID");return!0}}}},"targetId")]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"grey",children:"TTL:"}),e.jsx(z,{ref:f,inputClassName:"name-token-input white",inputCustomStyle:{paddingLeft:"10px",fontSize:"14px"},wrapperCustomStyle:{position:"relative",border:"1px solid var(--text-faded)",borderRadius:"var(--corner-radius)",maxWidth:"130px"},showValidationIcon:!0,showValidationOutline:!0,showValidationChecklist:!0,type:"number",minNumber:F,maxNumber:O,validationListStyle:{display:"none"},maxCharLength:O.toString().length,value:p,setValue:a=>w(+a),catchInvalidInput:!0,customPattern:new RegExp(`^[0-9]{1,${O.toString().length}}$`),validationPredicates:{[W.VALID_TTL]:{fn:a=>pe(+a)}}},"ttlSeconds")]})]})})}),onCancel:o,onClose:o,onNext:G(S)&&he(m)&&p>=F&&p<=O?()=>_():void 0,footer:e.jsx("div",{className:"flex"}),nextText:"Next",cancelText:"Cancel"})})}const Xe=Me();function ee(i,o){const r=[];return o.forEach(t=>{let c=!1;Object.entries(t).forEach(([,u])=>{var f,g;typeof u=="object"&&u!==null?ee(i,[u]).length>0&&(c=!0):(g=(f=u==null?void 0:u.toString())==null?void 0:f.toLowerCase())!=null&&g.includes(i.toLowerCase())&&(c=!0)}),c&&r.push(t)}),r}const Ze=({undernames:i,arnsDomain:o,info:r,antId:t,ownershipStatus:c,filter:u,refresh:f,isLoading:g})=>{const[m,R]=fe(),[{arioProcessId:S,antAoClient:T}]=ge(),[{wallet:p,walletAddress:w}]=J(),y=w?(r==null?void 0:r.Owner)===w.toString():!1,[,N]=be(),[,M]=we(),{data:h}=ye(),[I,_]=n.useState([]),[C,a]=n.useState([]),[v,x]=n.useState(),[k,j]=n.useState(),[U,D]=n.useState(),[Z,A]=n.useState();async function te({payload:s,workflowName:l,processId:b}){try{if(!b)throw new Error("Unable to interact with ANT contract - missing ID.");if(!(p!=null&&p.contractSigner)||!w)throw new Error("Unable to interact with ANT contract - missing signer.");const{id:d}=await _e({processId:b,payload:s,workflowName:l,signer:p==null?void 0:p.contractSigner,owner:w==null?void 0:w.toString(),dispatch:N,ao:T});V.emit("success",{name:"Manage Undernames",message:e.jsxs("span",{className:"flex flex-row whitespace-nowrap",style:{gap:"10px"},children:[l," complete."," ",e.jsx(B,{id:new q(d),type:K.INTERACTION,shouldLink:!0,characterCount:8})]})}),f&&f()}catch(d){V.emit("error",d)}finally{j(void 0),D(void 0)}}n.useEffect(()=>{if(i){const s=[];Object.entries(i).filter(([l])=>l!=="@").map(([l,b])=>{const d=(r==null?void 0:r.Handlers)??(r==null?void 0:r.HandlerNames)??[],se={undername:l,targetId:b.transactionId,ttlSeconds:b.ttlSeconds,action:e.jsxs("span",{className:"flex flex-row justify-end pr-3 gap-3",style:{gap:"15px"},children:[y&&e.jsx(X,{message:o?!(d!=null&&d.includes("approvePrimaryName"))||!(d!=null&&d.includes("removePrimaryNames"))?"Update ANT to access Primary Names workflow":(h==null?void 0:h.name)===$(l+"_"+o)?"Remove Primary Name":"Set Primary Name":"Loading...",icon:e.jsx("button",{disabled:!(d!=null&&d.includes("approvePrimaryName"))||!(d!=null&&d.includes("removePrimaryNames")),onClick:()=>{if(!o||!t)return;const P=$(l+"_"+o);(h==null?void 0:h.name)===P?N({type:"setTransactionData",payload:{names:[P],arioProcessId:S,assetId:t,functionName:"removePrimaryNames"}}):N({type:"setTransactionData",payload:{name:P,arioProcessId:S,assetId:S,functionName:"primaryNameRequest"}}),M({type:"setModalOpen",payload:{showPrimaryNameModal:!0}})},children:e.jsx(Ne,{className:($(l+"_"+o)==(h==null?void 0:h.name)?"text-primary fill-primary":"text-grey")+` 
                    w-[18px]
                    `})})}),e.jsx("button",{className:"fill-grey hover:fill-white",onClick:()=>{A(l),x(L.EDIT)},children:e.jsx(ve,{width:"16px",height:"16px",fill:"inherit"})}),e.jsx("button",{className:"fill-grey hover:fill-white",onClick:()=>{A(l),x(L.REMOVE),j({subDomain:l}),D(E.REMOVE_RECORD),N({type:"setWorkflowName",payload:E.REMOVE_RECORD})},children:e.jsx(We,{width:"16px",height:"16px",fill:"inherit"})})]})};s.push(se)}),_(s)}(!i||!Object.keys(i).length)&&_([])},[i,h]),n.useEffect(()=>{a(u?ee(u,I):[])},[u,I,h]);const ae=["undername","targetId","ttlSeconds","action"].map(s=>Xe.accessor(s,{id:s,header:s=="action"?"":s=="targetId"?"Target ID":s=="ttlSeconds"?"TTL Seconds":Se(s),sortDescFirst:!0,cell:({row:l})=>{const b=l.getValue(s);if(!b)return"";switch(s){case"undername":return e.jsx(X,{tooltipOverrides:{overlayClassName:"w-fit",overlayInnerStyle:{width:"fit-content"}},message:e.jsx("span",{className:"w-fit whitespace-nowrap text-white",children:b}),icon:e.jsxs(je,{className:"link gap-2 items-center w-fit",to:`https://${Y(b)}_${Y(o??"")}.${Ce.ARNS.HOST}`,target:"_blank",children:[Q(Te(b),30)," ",e.jsx(Ie,{width:"12px",height:"12px",fill:"var(--text-white)"})]})});case"targetId":return e.jsx(B,{id:b,shouldLink:!0,characterCount:8,type:K.TRANSACTION});default:return b}}}));return e.jsxs("div",{children:[e.jsx(Ee,{columns:ae,data:g?[]:C.length?C:I.length?I:[],isLoading:!1,noDataFoundText:g?e.jsxs("span",{className:"h-fit flex flex-col text-white w-full items-center p-5 justify-center",children:[e.jsx(Re,{animationData:De,loop:!0,className:"h-[100px]"}),e.jsx("span",{children:"Loading Undernames..."})]}):e.jsx("span",{className:"h-20 flex w-full items-center justify-center",children:"No Undernames Found"}),defaultSortingState:{id:"undername",desc:!0},tableClass:"bg-background border-[1px] border-dark-grey rounded border-collapse",rowClass:s=>{const l="*:pl-4";return(s==null?void 0:s.row)!==void 0?"hover:bg-primary-thin border-b-[1px] border-dark-grey "+l:(s==null?void 0:s.headerGroup)!==void 0?l+" border-b-[1px] border-dark-grey":"border-t-[1px] border-dark-grey "+l},addOnAfterTable:c===void 0?e.jsx(e.Fragment,{}):e.jsx("div",{className:"w-full flex flex-row text-primary font-semibold rounded-b-md border-b-[1px] border-x-[1px] border-dark-grey text-sm",children:e.jsxs("button",{className:"flex flex-row w-full justify-start items-center p-3 rounded-b-md bg-background hover:bg-primary-gradient text-primary hover:text-primary fill-primary hover:fill-black transition-all",style:{gap:"10px"},onClick:()=>x(L.CREATE),children:[e.jsx($e,{className:"size-4 text-primary fill-black"}),"Add Undername"]})}),paginationConfig:{pageSize:8}}),v==L.CREATE&&t&&c?e.jsx(Ge,{closeModal:()=>{R({...m,modal:void 0}),x(void 0)},payloadCallback:s=>{j(s),D(E.SET_RECORD),N({type:"setWorkflowName",payload:E.SET_RECORD}),x(void 0)},antId:t}):e.jsx(e.Fragment,{children:" "}),v===L.EDIT&&Z&&c&&e.jsx(Ae,{antId:new q(t),undername:Z,closeModal:()=>{A(void 0),x(void 0)},payloadCallback:s=>{j(s),D(E.EDIT_RECORD),N({type:"setWorkflowName",payload:E.EDIT_RECORD}),A(void 0),x(void 0)}}),t&&k&&U&&c?e.jsx(Le,{interactionType:U,confirm:()=>te({payload:k,workflowName:U,processId:t}),cancel:()=>{j(void 0),D(void 0),A(void 0)}}):e.jsx(e.Fragment,{})]})};function Ye(){var w;const i=ke(),{id:o,name:r}=Oe(),{data:t,isLoading:c,refetch:u}=Ve({domain:r,antId:G(o)?o:void 0}),[{walletAddress:f}]=J(),[g,m]=n.useState(!1),[R,S]=n.useState(void 0),[T,p]=n.useState("");return n.useEffect(()=>{var y,N;if(!o&&!r){V.emit("error",new Error("Missing ANT transaction ID.")),i("/manage/ants");return}t!=null&&t.owner&&(t!=null&&t.controllers)&&S(Ue(t==null?void 0:t.owner,t==null?void 0:t.controllers,f==null?void 0:f.toString())),m(!!((y=t==null?void 0:t.arnsRecord)!=null&&y.undernameLimit)&&((N=t==null?void 0:t.arnsRecord)==null?void 0:N.undernameLimit)>=Pe)},[o,r,t==null?void 0:t.owner,t==null?void 0:t.controllers,f,c]),e.jsx(e.Fragment,{children:e.jsx("div",{className:"px-[100px]",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex flex-justify-between",children:e.jsxs("div",{className:"flex flex-row",style:{justifyContent:"space-between"},children:[e.jsx("h2",{className:"white text-[2rem] whitespace-nowrap",children:"Manage Undernames"}),e.jsx(X,{message:g?"Max undername support reached":"Increase undername support",icon:e.jsx("button",{disabled:c||g,className:`button-secondary ${c||g?"disabled-button":"hover"}`,style:{padding:"9px",gap:"8px",fontSize:"14px",color:"var(--accent)",fontFamily:"Rubik"},onClick:()=>i(`/manage/names/${Fe(r)}/upgrade-undernames`),children:"Increase Undernames"})})]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex w-full p-3 border-x-[1px] border-t-[1px] border-dark-grey rounded-t-[5px] relative",children:[e.jsx(He,{width:"18px",height:"18px",className:"fill-white absolute top-[13.5px] left-[11px]"}),e.jsx("input",{className:"pl-7 flex bg-background w-full focus:outline-none text-white placeholder:text-dark-grey",onChange:y=>p(y.target.value),value:T,placeholder:`Search undernames on '${r??Q(o??"",10)}'`})]}),e.jsx(Ze,{undernames:(t==null?void 0:t.records)??{},arnsDomain:r,info:t==null?void 0:t.info,antId:(w=t==null?void 0:t.arnsRecord)==null?void 0:w.processId,ownershipStatus:R,isLoading:c,filter:T,refresh:()=>{c||u()}})]})]})})})}export{Ye as default};
//# sourceMappingURL=Undernames-65af25f0.js.map
