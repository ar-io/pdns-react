import{r as t,B as te,E as ne,aP as ce,aQ as M,aR as Q,e as F,j as e,G as se,V as H,aS as de,I as X,aT as ue,aU as xe,T as ee,a0 as re,$ as V,Z as oe,J as Z,aV as me,ac as ie,aW as he,H as pe,aX as fe,a3 as le,aY as ge,A as U,aZ as q,aM as we,a_ as ve,a$ as Se,b0 as Ce,b1 as ye,b2 as Ne,a1 as z,a as be,u as je,af as Ie,b as Te,Q as K,a4 as Ee,L as Re,O as Ae}from"./index-d8f875ce.js";import{S as De,u as Ve,T as ke,C as Le,d as _e}from"./TransactionSuccessCard-67e8246b.js";import{W as Pe}from"./WarningCard-e8613c0c.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},o=new Error().stack;o&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[o]="5c0c53f9-19bb-4138-8f15-48c2359f65a8",r._sentryDebugIdIdentifier="sentry-dbid-5c0c53f9-19bb-4138-8f15-48c2359f65a8")}catch{}})();const ae=r=>t.createElement("svg",{width:"current",height:"current",viewBox:"0 0 16 16",fill:"current",xmlns:"http://www.w3.org/2000/svg",...r},t.createElement("path",{d:"M15.5 8C15.5 8.16576 15.4342 8.32473 15.3169 8.44194C15.1997 8.55915 15.0408 8.625 14.875 8.625H8.625V14.875C8.625 15.0408 8.55915 15.1997 8.44194 15.3169C8.32473 15.4342 8.16576 15.5 8 15.5C7.83424 15.5 7.67527 15.4342 7.55806 15.3169C7.44085 15.1997 7.375 15.0408 7.375 14.875V8.625H1.125C0.95924 8.625 0.800269 8.55915 0.683058 8.44194C0.565848 8.32473 0.5 8.16576 0.5 8C0.5 7.83424 0.565848 7.67527 0.683058 7.55806C0.800269 7.44085 0.95924 7.375 1.125 7.375H7.375V1.125C7.375 0.95924 7.44085 0.800269 7.55806 0.683058C7.67527 0.565848 7.83424 0.5 8 0.5C8.16576 0.5 8.32473 0.565848 8.44194 0.683058C8.55915 0.800269 8.625 0.95924 8.625 1.125V7.375H14.875C15.0408 7.375 15.1997 7.44085 15.3169 7.55806C15.4342 7.67527 15.5 7.83424 15.5 8Z",fill:"current"})),Me=r=>t.createElement("svg",{width:"current",height:"current",viewBox:"0 0 24 24",fill:"current",xmlns:"http://www.w3.org/2000/svg",...r},t.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21 6.0014H16V4.3314C15.9512 2.9985 14.833 1.95641 13.5 2.0014H10.5C9.16696 1.95642 8.04885 2.9985 8 4.3314V6.0014H3C2.44771 6.0014 2 6.44912 2 7.0014C2 7.55369 2.44771 8.0014 3 8.0014H4V19.0014C4 20.6583 5.34315 22.0014 7 22.0014H17C18.6569 22.0014 20 20.6583 20 19.0014V8.0014H21C21.5523 8.0014 22 7.55369 22 7.0014C22 6.44912 21.5523 6.0014 21 6.0014ZM10 4.33C10 4.17 10.21 4 10.5 4H13.5C13.79 4 14 4.17 14 4.33V6H10V4.33ZM17 20C17.5523 20 18 19.5523 18 19V8H6V19C6 19.5523 6.44771 20 7 20H17ZM9 17C9.55229 17 10 16.5523 10 16V12C10 11.4477 9.55229 11 9 11C8.44771 11 8 11.4477 8 12V16C8 16.5523 8.44771 17 9 17ZM16 16C16 16.5523 15.5523 17 15 17C14.4477 17 14 16.5523 14 16V12C14 11.4477 14.4477 11 15 11C15.5523 11 16 11.4477 16 12V16Z",fill:"current"}));function Oe({antId:r,closeModal:o,payloadCallback:w}){const[{arweaveDataProvider:v}]=te(),u=ne(),d=t.useRef(null),x=t.useRef(null),N=t.useRef(null),[i,S]=t.useState(""),[C,h]=t.useState(ce.toString()),[p,g]=t.useState(M),[j,k]=t.useState({}),[m,y]=t.useState(Q);t.useEffect(()=>{var a;f(),(a=N.current)==null||a.focus()},[r.toString()]);async function f(){try{const a=await v.getRecords({filters:{processId:[r]}});k(a);const T=Object.keys(a).length?Math.min(...Object.keys(a).map(L=>L.length)):0;y(Q-T)}catch(a){F.emit("error",a)}}function O(){w({subDomain:i,transactionId:C,ttlSeconds:p})}function I(a,T){return Object.keys(T).filter(L=>a.length+L.length>Q)}return e.jsx("div",{className:"modal-container",style:u?{padding:"none"}:{},children:e.jsx(se,{title:e.jsx("h2",{className:"white",children:"Add Undername"}),body:e.jsx("form",{children:e.jsx("div",{className:"flex flex-column",style:{fontSize:"14px",width:"500px"},children:e.jsxs("div",{className:"flex flex-column",style:{paddingBottom:"30px"},children:[e.jsxs("div",{className:"flex flex-column",style:{gap:"15px"},children:[e.jsx("span",{className:"grey",children:"Undername Title:"}),e.jsxs("span",{className:"flex flex-row",style:{position:"relative"},children:[e.jsx(H,{ref:N,inputClassName:"name-token-input white",inputCustomStyle:{paddingLeft:"10px",fontSize:"14px",paddingRight:"80px"},wrapperCustomStyle:{width:"100%",border:"1px solid var(--text-faded)",borderRadius:"var(--corner-radius)"},showValidationIcon:!0,showValidationOutline:!0,showValidationChecklist:!0,validationListStyle:{display:"none"},value:i,setValue:a=>S(a),catchInvalidInput:!1,maxCharLength:m,customPattern:de,validationPredicates:{[X.UNDERNAME]:{fn:a=>ue(a)},"Dashes and Underscores cannot be leading or trailing":{fn:a=>xe(a)}}},"undername"),e.jsxs("span",{className:"flex flex-row grey",style:{position:"absolute",top:"0px",bottom:"0px",right:i.length?"35px":"10px",width:"fit-content"},children:[i.length," / ",m]})]}),I(i,j).length?e.jsx(Pe,{text:e.jsxs("span",{children:["This ANT has"," ",e.jsx(ee,{title:e.jsx("div",{className:"flex flex-column",style:{padding:"5px",gap:"5px",boxSizing:"border-box"},children:I(i,j).map(a=>e.jsx("span",{children:a},a))}),color:"var(--card-bg)",placement:"top",showArrow:!0,children:e.jsxs("span",{className:"underline bold",children:[I(i,j).length," ","name",I(i,j).length>1?"s":""]})})," ","that will not support this undername as it is over their supported length."]})}):e.jsx(e.Fragment,{})]}),e.jsxs("div",{className:"flex flex-column",style:{gap:"15px"},children:[e.jsx("span",{className:"grey",children:"Target ID:"}),e.jsx(H,{ref:d,inputClassName:"name-token-input white",inputCustomStyle:{paddingLeft:"10px",fontSize:"14px",paddingRight:"40px"},wrapperCustomStyle:{position:"relative",border:"1px solid var(--text-faded)",borderRadius:"var(--corner-radius)"},showValidationIcon:!0,showValidationOutline:!0,showValidationChecklist:!0,validationListStyle:{display:"none"},maxCharLength:43,value:C,setValue:h,catchInvalidInput:!0,customPattern:re,validationPredicates:{[X.ARWEAVE_ID]:{fn:a=>v.validateArweaveId(a)}}},"targetId")]}),e.jsxs("div",{className:"flex flex-column",style:{gap:"15px"},children:[e.jsx("span",{className:"grey",children:"TTL:"}),e.jsx(H,{ref:x,inputClassName:"name-token-input white",inputCustomStyle:{paddingLeft:"10px",fontSize:"14px"},wrapperCustomStyle:{position:"relative",border:"1px solid var(--text-faded)",borderRadius:"var(--corner-radius)",maxWidth:"130px"},showValidationIcon:!0,showValidationOutline:!0,showValidationChecklist:!0,type:"number",minNumber:M,maxNumber:V,validationListStyle:{display:"none"},maxCharLength:V.toString().length,value:p,setValue:a=>g(+a),catchInvalidInput:!0,customPattern:new RegExp(`^[0-9]{1,${V.toString().length}}$`),validationPredicates:{[X.VALID_TTL]:{fn:a=>oe(+a)}}},"ttlSeconds")]})]})})}),onCancel:o,onClose:o,onNext:Z(C)&&me(i)&&p>=M&&p<=V?()=>O():void 0,footer:e.jsx("div",{className:"flex"}),nextText:"Next",cancelText:"Cancel"})})}function Ue({antId:r,undername:o,closeModal:w,payloadCallback:v}){const[{arweaveDataProvider:u}]=te(),d=ne(),x=t.useRef(null),N=t.useRef(null),[i,S]=t.useState(""),[C,h]=t.useState(M),[p,g]=t.useState();t.useEffect(()=>{j(r),x.current&&x.current.focus()},[r]);async function j(m){try{const f=await ie.init({processId:m.toString()}).getRecord({undername:o});if(!f)throw new Error("Undername not found");S(f==null?void 0:f.transactionId),h(he.clamp(f==null?void 0:f.ttlSeconds,M,V)),g(p)}catch(y){F.emit("error",y)}}function k(){v({subDomain:o,transactionId:i,ttlSeconds:C,previousRecord:p})}return e.jsx("div",{className:"modal-container",style:d?{padding:"none"}:{},children:e.jsx(se,{title:e.jsxs("h2",{className:"white",children:["Edit ",pe(o,40)]}),body:e.jsx("div",{className:"flex flex-column",style:{fontSize:"14px",maxWidth:"575px",minWidth:"475px"},children:e.jsxs("div",{className:"flex flex-column",style:{paddingBottom:"30px"},children:[e.jsxs("div",{className:"flex flex-column",style:{gap:"15px"},children:[e.jsx("span",{className:"grey",children:"Target ID:"}),e.jsx(H,{ref:x,inputClassName:"name-token-input white",inputCustomStyle:{paddingLeft:"10px",fontSize:"14px",paddingRight:"40px"},wrapperCustomStyle:{position:"relative",border:"1px solid var(--text-faded)",borderRadius:"var(--corner-radius)"},showValidationIcon:!0,showValidationOutline:!0,showValidationChecklist:!0,validationListStyle:{display:"none"},maxCharLength:43,value:i,setValue:S,catchInvalidInput:!0,customPattern:re,validationPredicates:{[X.ARWEAVE_ID]:{fn:m=>u.validateArweaveId(m)}}},"targetId")]}),e.jsxs("div",{className:"flex flex-column",style:{gap:"15px"},children:[e.jsx("span",{className:"grey",children:"TTL:"}),e.jsx(H,{ref:N,inputClassName:"name-token-input white",inputCustomStyle:{paddingLeft:"10px",fontSize:"14px"},wrapperCustomStyle:{position:"relative",border:"1px solid var(--text-faded)",borderRadius:"var(--corner-radius)",maxWidth:"130px"},showValidationIcon:!0,showValidationOutline:!0,showValidationChecklist:!0,type:"number",minNumber:M,maxNumber:V,validationListStyle:{display:"none"},maxCharLength:V.toString().length,value:C,setValue:m=>h(+m),catchInvalidInput:!0,customPattern:new RegExp(`^[0-9]{1,${V.toString().length}}$`),validationPredicates:{[X.VALID_TTL]:{fn:m=>oe(+m)}}},"ttlSeconds")]})]})}),onCancel:w,onClose:w,onNext:Z(i)&&fe({name:o})&&C>=M&&C<=V?()=>k():void 0,footer:e.jsx("div",{className:"flex"}),nextText:"Next",cancelText:"Cancel"})})}function ze(r,o){const[{gateway:w,arweaveDataProvider:v}]=te(),[{walletAddress:u}]=le(),[d,x]=t.useState(!0),[N,i]=t.useState("name"),[S,C]=t.useState(),[h,p]=t.useState([]),[g,j]=t.useState([]),[k,m]=t.useState([]),[y,f]=t.useState(!0),[O,I]=t.useState(),a=t.useRef(null),[T,L]=t.useState(""),[R,A]=t.useState(!1),[Y,G]=t.useState(""),[_,W]=t.useState(!1);t.useEffect(()=>{!r&&!o||$(r,o)},[r,o,u]),t.useEffect(()=>{j(P())},[_]),t.useEffect(()=>{if(T){const D=h.filter(n=>n.name.toLowerCase().startsWith(T.toLowerCase()));m(D)}else m([])},[T,u]);function P(){return[{title:e.jsxs("button",{className:"flex-row pointer grey",style:{gap:"0.5em"},onClick:()=>i("name"),children:[e.jsx("span",{children:"Undername"}),N==="name"?e.jsx(q,{width:10,height:10,fill:"var(--text-grey)",style:d?{}:{transform:"rotate(180deg)"}}):e.jsx(e.Fragment,{})]}),dataIndex:"name",key:"name",align:"left",width:"18%",className:"grey manage-assets-table-header",ellipsis:!0,onHeaderCell:()=>({onClick:()=>{h.sort((n,l)=>d?l.name.localeCompare(n.name):n.name.localeCompare(l.name)),p([...h]),x(!d)}}),render:n=>e.jsx(we,{to:`https://${n}_${Y}.${w}`,rel:"noreferrer",target:"_blank",className:"link",children:n})},{title:e.jsxs("button",{className:"flex-row pointer grey",style:{gap:"0.5em"},onClick:()=>i("targetID"),children:[e.jsx("span",{children:"Target ID"}),N==="targetID"?e.jsx(q,{width:10,height:10,fill:"var(--text-grey)",style:d?{}:{transform:"rotate(180deg)"}}):e.jsx(e.Fragment,{})]}),dataIndex:"targetID",key:"targetID",align:"left",width:"18%",className:"grey manage-assets-table-header",render:n=>n==="N/A"||!Z(n)?n:e.jsx(ve,{id:new U(n),characterCount:12,shouldLink:!0,type:Se.TRANSACTION}),onHeaderCell:()=>({onClick:()=>{h.sort((n,l)=>d?n.targetID.localeCompare(l.targetID):l.targetID.localeCompare(n.targetID)),p([...h]),x(!d)}})},{title:e.jsxs("button",{className:"flex-row pointer grey",style:{gap:"0.5em"},onClick:()=>i("ttlSeconds"),children:[e.jsx("span",{children:"TTL"}),N==="ttlSeconds"?e.jsx(q,{width:10,height:10,fill:"var(--text-grey)",style:d?{}:{transform:"rotate(180deg)"}}):e.jsx(e.Fragment,{})]}),dataIndex:"ttlSeconds",key:"ttlSeconds",align:"left",width:"18%",className:"grey manage-assets-table-header",render:n=>n,onHeaderCell:()=>({onClick:()=>{h.sort((n,l)=>d?n.ttlSeconds-l.ttlSeconds:l.ttlSeconds-n.ttlSeconds),p([...h]),x(!d)}})},{title:e.jsxs("div",{className:"flex flex-row center undername-search-wrapper",style:{gap:"1px",justifyContent:"flex-end",boxSizing:"border-box"},children:[e.jsx("button",{className:"flex button center pointer",style:{zIndex:10},onClick:()=>A(!R),children:e.jsx(Ce,{width:"16px",height:"16px",fill:R?"var(--text-white)":"var(--text-grey)"})}),R?e.jsxs("span",{className:"flex flex-row center",style:{gap:"1px",justifyContent:"flex-end",width:"fit-content",boxSizing:"border-box"},children:[e.jsx(H,{ref:a,value:T,setValue:n=>L(n),catchInvalidInput:!0,showValidationIcon:!1,placeholder:"Search for a name",maxCharLength:61,wrapperCustomStyle:{position:"relative",boxSizing:"border-box"},inputCustomStyle:{width:"100%",minWidth:"100px",overflow:"hidden",fontSize:"13px",outline:"none",color:"white",alignContent:"center",borderBottom:"none",boxSizing:"border-box",background:"transparent",borderRadius:"var(--corner-radius)",border:"none",paddingRight:"10px"},customPattern:ye,validationPredicates:{}}),e.jsx("button",{className:"flex button center pointer",onClick:()=>{L(""),A(!1)},children:e.jsx(Ne,{width:"18px",height:"18px",fill:"var(--text-grey)"})})]}):e.jsx(e.Fragment,{})]}),className:"manage-assets-table-header",render:(n,l)=>e.jsx("div",{className:"flex flex-row action-buttons fade-in",style:{gap:"10px",justifyContent:"flex-end"},children:_&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{trigger:["hover"],title:"Edit",color:"var(--card-bg)",placement:"top",rootClassName:"notification-tooltip",children:e.jsx("button",{className:"button pointer",onClick:()=>{C(l),I(z.EDIT)},children:e.jsx(De,{width:18,height:18,fill:"var(--text-grey)"})})}),e.jsx(ee,{trigger:["hover"],title:"Delete",color:"#222224",placement:"top",rootClassName:"notification-tooltip",children:e.jsx("button",{className:"button pointer",onClick:()=>{C(l),I(z.REMOVE)},children:e.jsx(Me,{width:18,height:18,fill:"var(--text-grey)"})})})]})}),align:"right",width:"10%",key:"action",dataIndex:"action"}]}async function $(D,n){let l;if(D)l=D;else if(n){const s=await ge({fn:()=>v.getRecord({domain:n}),maxTries:5,initialDelay:1e3,shouldRetry:E=>!(E!=null&&E.processId)});s&&(l=new U(s==null?void 0:s.processId))}if(!l){f(!1);return}f(!0);const J=await v.getRecords({filters:{processId:[l]}}).then(s=>Object.keys(s)[0]).catch(s=>(console.debug("No domain found for ANT",l==null?void 0:l.toString()),F.emit("error",s),""));G(J);const B=await ie.init({processId:l.toString()}).getState(),c=Object.entries(B.Records).map(([s,E])=>s==="@"?void 0:{name:s,targetID:E.transactionId,ttlSeconds:E.ttlSeconds,status:0,key:s}).filter(s=>s!==void 0).sort((s,E)=>s.status-E.status);p(c);const b=u?B.Controllers.includes(u.toString())||B.Owner===u.toString():!1;W(b),f(!1)}return{isLoading:y,columns:g,rows:k.length?k:h,sortField:N,sortAscending:d,selectedRow:S,action:O,setAction:D=>I(D),refresh:()=>$(r,o)}}function $e(){const r=be(),{id:o,name:w}=je(),{data:v}=Ve({domain:w,antId:o?new U(o):void 0}),[{walletAddress:u,wallet:d}]=le(),[x,N]=t.useState(),[i,S]=t.useState(),{isLoading:C,columns:h,rows:p,selectedRow:g,sortAscending:j,sortField:k,action:m,setAction:y,refresh:f}=ze(x,w),[O,I]=t.useState(!0),[a,T]=t.useState(1),[L,R]=Ie(),[A,Y]=t.useState(),[G,_]=t.useState(),[W,P]=t.useState(),[{interactionResult:$,workflowName:D},n]=Te();t.useEffect(()=>{if(!o&&!w){F.emit("error",new Error("Missing ANT transaction ID.")),r("/manage/ants");return}I(C),S(g),O&&J(),y(m),v.owner&&v.controllers&&l(v.owner,v.controllers,u==null?void 0:u.toString()).then(c=>Y(c)),m===z.REMOVE&&x&&(g!=null&&g.name)&&(_({subDomain:g==null?void 0:g.name}),P(K.REMOVE_RECORD))},[o,w,j,k,g,m,p,u]);async function l(c,b,s){if(c===s)return"owner";if(s&&b.includes(s))return"controller"}async function J(){try{let c;if(Z(o))c=new U(o);else if(w){const b=v.arnsRecord;c=new U(b==null?void 0:b.processId)}if(!c)throw new Error("Unable to load undernames, cannot resolve ANT ID.");N(c)}catch(c){F.emit("error",c),r("/manage/ants")}}async function B({payload:c,workflowName:b,processId:s}){try{if(!s)throw new Error("Unable to interact with ANT contract - missing ID.");if(!(d!=null&&d.arconnectSigner)||!u)throw new Error("Unable to interact with ANT contract - missing signer.");await _e({processId:s,payload:c,workflowName:b,signer:d==null?void 0:d.arconnectSigner,owner:u==null?void 0:u.toString(),dispatch:n})}catch(E){F.emit("error",E)}finally{_(void 0),P(void 0),f()}}return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"page",children:e.jsxs("div",{className:"flex-column",children:[$?e.jsx(ke,{txId:new U($.id),close:()=>{n({type:"reset"})},title:`${D} completed`}):e.jsx(e.Fragment,{}),e.jsx("div",{className:"flex flex-justify-between",children:e.jsxs("div",{className:"flex flex-row",style:{justifyContent:"space-between"},children:[e.jsx("h2",{className:"white",children:"Manage Undernames"}),A?e.jsxs("button",{disabled:A===void 0,className:"button-secondary center",style:{gap:"10px",padding:"9px 12px",fontSize:"14px",textAlign:"center"},onClick:()=>R({modal:z.CREATE}),children:[e.jsx(ae,{width:"16px",height:"16px",fill:"var(--accent)"}),"Add Undername"]}):e.jsx(e.Fragment,{})]})}),O?e.jsx("div",{className:"flex center",style:{paddingTop:"10%",justifyContent:"center"},children:e.jsx(Ee,{message:"Loading undernames..."})}):e.jsx(Re,{onRow:()=>({className:"hovered-row"}),prefixCls:"manage-undernames-table",bordered:!1,scroll:{x:!0},columns:h,dataSource:p,pagination:{position:["bottomCenter"],rootClassName:"table-pagination",itemRender:(c,b,s)=>Ae({page:c,type:b,originalElement:s,currentPage:a}),onChange:c=>T(c),showPrevNextJumpers:!0,showSizeChanger:!1,current:a},locale:{emptyText:e.jsxs("div",{className:"flex flex-column center",style:{padding:"100px",boxSizing:"border-box",width:"100%"},children:[e.jsx("span",{className:"white bold",style:{fontSize:"16px"},children:"No Undernames Found"}),e.jsx("span",{className:"grey",style:{fontSize:"13px",maxWidth:"400px"},children:"Arweave Name Tokens (ANTs) provide ownership and control of ArNS names. With ANTs you can easily manage, transfer, and adjust your domains, as well as create undernames."}),e.jsx("div",{className:"flex flex-row center",style:{gap:"16px"},children:A?e.jsxs("button",{className:"button-secondary center",style:{gap:"10px",padding:"9px 12px",fontSize:"14px",textAlign:"center"},onClick:()=>R({modal:z.CREATE}),children:[e.jsx(ae,{width:"16px",height:"16px",fill:"var(--accent)"}),"Add Undername"]}):e.jsx(e.Fragment,{})})]})}})]})}),L.has("modal")&&x&&A?e.jsx(Oe,{closeModal:()=>{R({}),S(void 0),R({})},payloadCallback:c=>{_(c),P(K.SET_RECORD),y(void 0),S(void 0),R({})},antId:x}):e.jsx(e.Fragment,{children:" "}),m===z.EDIT&&x&&(i!=null&&i.name)&&A?e.jsx(Ue,{closeModal:()=>{y(void 0),S(void 0)},payloadCallback:c=>{_(c),P(K.EDIT_RECORD),y(void 0),S(void 0)},antId:x,undername:i.name}):e.jsx(e.Fragment,{children:" "}),x&&G&&W&&A?e.jsx(Le,{interactionType:W,confirm:()=>B({payload:G,workflowName:W,processId:x}),cancel:()=>{_(void 0),P(void 0),S(void 0),y(void 0)}}):e.jsx(e.Fragment,{})]})}export{$e as default};
//# sourceMappingURL=Undernames-2e31601f.js.map
