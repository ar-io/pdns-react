import{ao as i,ax as w,aj as A,ay as h,az as k,A as S,aA as B,al as p,aB as U,f as y,aC as L,j as t,a as F,y as P,b as W,c as M,z as Y,r as f,aD as N,aE as X,ap as q,W as H,au as $,aF as G}from"./index-54fc4818.js";import{S as z}from"./Info-d9e5d746.js";import{T as J}from"./TransactionCost-dd55cd17.js";import{S as K}from"./StepProgressBar-b7e05840.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="0996c8d5-698c-4413-93fc-faf75c942f45",e._sentryDebugIdIdentifier="sentry-dbid-0996c8d5-698c-4413-93fc-faf75c942f45")}catch{}})();async function Q({payload:e,workflowName:a,arioContract:c,arweaveCompositeProvider:u,contractTxId:x,dispatch:d}){let n,s;try{if(!c)throw new Error("ArIO provider is not defined");switch(d({type:"setSigning",payload:!0}),a){case i.BUY_RECORD:{let o;e.contractTxId===A?e.targetId&&e.state&&(e.state.records["@"]={transactionId:e.targetId,ttlSeconds:h}):e.targetId&&(o=k({contractId:new S(e.contractTxId),input:{function:"setRecord",subDomain:"@",transactionId:e.targetId,ttlSeconds:h}}));const E=B(i.BUY_RECORD,e);n={id:e.contractTxId===A?await u.registerAtomicName({walletAddress:e.walletAddress,registryId:p,srcCodeTransactionId:new S(U),initialState:e.state,domain:e.name,type:e.type,years:e.years,auction:e.auction??!1,qty:e.qty,isBid:e.isBid??!1}):await u.writeTransaction({walletAddress:e.walletAddress,contractTxId:p,dryWrite:!0,payload:{function:w.BUY_RECORD,...E},tags:o,interactionDetails:{isBid:e.isBid?e.isBid:!1}}),owner:e.walletAddress},s=w.BUY_RECORD;break}case i.EXTEND_LEASE:n=await c.extendLease({domain:e.name,years:e.years}),s=w.EXTEND_RECORD;break;case i.INCREASE_UNDERNAMES:n=await c.increaseUndernameLimit({domain:e.name,qty:e.qty}),s=w.INCREASE_UNDERNAME_COUNT;break;default:throw new Error(`Unsupported workflow name: ${a}`)}}catch(o){y.emit("error",o)}finally{d({type:"setSigning",payload:!1})}if(!n)throw new Error("Failed to dispatch ArIO interaction");if(!s)throw new Error("Failed to set workflow name");const r={deployer:e.walletAddress.toString(),contractTxId:x.toString(),id:await n.id,payload:{...e,function:s},type:"interaction"};return await L.push(x.toString(),r),d({type:"setWorkflowName",payload:a}),d({type:"setInteractionResult",payload:r}),r}function R({workflowName:e,...a}){switch(e){case i.INCREASE_UNDERNAMES:return`Increasing your undernames is paid in ${a.ioTicker} tokens, and an Arweave network fee paid in AR tokens.`;case i.EXTEND_LEASE:case i.BUY_RECORD:return`This includes a registration fee (paid in ${a.ioTicker} tokens) and the Arweave network fee (paid in AR tokens).`;default:return}}function _({workflowName:e,...a}){switch(e){case i.INCREASE_UNDERNAMES:case i.EXTEND_LEASE:return t.jsx("h1",{className:"flex white",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case i.BUY_RECORD:return`Review your ${a.auction?"Auction":"Purchase"}`;default:return}}function ae(){const e=F(),[{ioTicker:a,arioContract:c,arnsContractId:u,arweaveDataProvider:x}]=P(),[{walletAddress:d}]=W(),[{workflowName:n,interactionType:s,transactionData:r,interactionResult:o},E]=M(),m=Y(),[T,D]=f.useState(),[l,C]=f.useState(N(s)),[g,v]=f.useState(_({workflowName:n})),[I,b]=f.useState(R({workflowName:n,ioTicker:a}));f.useEffect(()=>{!r&&!n&&e("/"),D(X({interactionType:s,transactionData:{...r,deployedTransactionId:o==null?void 0:o.id}})),b(R({workflowName:n,ioTicker:a})),C(N(s)),v(_({workflowName:n,auction:{...r}.auction}))},[r,o,n,s,d]);async function O(){try{if(!(c instanceof G))throw new Error("Wallet must be connected to dispatch transactions.");if(!r||!n)throw new Error("Transaction data is missing");await Q({arioContract:c,arweaveCompositeProvider:x,workflowName:n,payload:r,contractTxId:u,dispatch:E}),e("/transaction/complete")}catch(j){y.emit("error",j)}}return T?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:m?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[l&&l.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"30px",width:"100%"},children:t.jsx(K,{stage:3,stages:l})}):t.jsx(t.Fragment,{}),typeof g=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"80px 0px",borderTop:l!=null&&l.length?"solid 1px var(--text-faded)":""},children:g}):g,t.jsx(H,{...T,bordered:!0,compact:!1}),t.jsx(J,{fee:{[a]:r==null?void 0:r.interactionPrice},info:I&&t.jsxs("div",{className:"flex flex-row flex-left",style:{gap:"10px",maxWidth:"50%",justifyContent:"flex-start",alignItems:"flex-start"},children:[t.jsx(z,{width:"20px",height:"20px",fill:"var(--text-grey)"}),t.jsx("span",{className:"flex flex-column flex-left grey text",style:{textAlign:"left",lineHeight:"1.5em"},children:I})]})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx($,{onNext:()=>O(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx(q,{loading:!0,message:"Loading transaction data..."})}export{ae as default};
//# sourceMappingURL=TransactionReview-789c1583.js.map
