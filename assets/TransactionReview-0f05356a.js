import{aU as h,bv as m,bc as b,b_ as v,b$ as L,c0 as O,b4 as P,b1 as B,c1 as F,c2 as M,c3 as Y,j as t,a as H,aE as X,aW as $,aX as G,b as q,aF as z,r as x,c4 as _,c5 as J,bw as K,aM as Q,bC as V,c6 as Z,c7 as ee}from"./index-99e13c60.js";import{A as te}from"./ANTCard-b78185f6.js";import{W as re}from"./WarningCard-b5599330.js";import{T as se}from"./TransactionCost-9db3cb0b.js";import{S as ae}from"./StepProgressBar-94dd516c.js";import{g as j}from"./transaction-descriptions-ac0e38e7.js";import"./useBreakpoint-eb5cd51a.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},s=new Error().stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="8453934d-f035-46b7-8a53-dbf0486e88c5",e._sentryDebugIdIdentifier="sentry-dbid-8453934d-f035-46b7-8a53-dbf0486e88c5")}catch{}})();async function ne({payload:e,workflowName:s,owner:f,arioContract:d,processId:y,dispatch:g,signer:u,ao:S,scheduler:l=Y}){var r;let n;const a=setTimeout(()=>{h.emit("network:ao:congested",!0)},1e4);try{if(!d)throw new Error("ArIO provider is not defined");if(!u)throw new Error("signer is not defined");switch(g({type:"setSigning",payload:!0}),s){case m.BUY_RECORD:{const{name:o,type:E,years:I}=e;let i=e.processId;if(i==="atomic"){const c=e.state||L(f.toString(),(r=e.targetId)==null?void 0:r.toString());i=await O({state:c,signer:P(u),ao:S,scheduler:l,luaCodeTxId:B}),await F.init({signer:u,processId:M}).register({processId:i}).catch(w=>{h.emit("error",new Error(`Failed to register ANT process: ${w}. You may need to manually register the process`))})}const T=await d.buyRecord({name:b(o),type:E,years:I,processId:i});e.processId=i,n=T;break}case m.EXTEND_LEASE:n=await d.extendLease({name:b(e.name),years:e.years},v);break;case m.INCREASE_UNDERNAMES:n=await d.increaseUndernameLimit({name:b(e.name),increaseCount:e.qty},v);break;default:throw new Error(`Unsupported workflow name: ${s}`)}}catch(o){h.emit("error",o)}finally{g({type:"setSigning",payload:!1}),clearTimeout(a)}if(!n)throw new Error("Failed to dispatch ArIO interaction");const p={deployer:f.toString(),processId:y.toString(),id:n.id,type:"interaction",payload:e};return g({type:"setWorkflowName",payload:s}),g({type:"setInteractionResult",payload:p}),p}function D({workflowName:e,...s}){switch(e){case m.INCREASE_UNDERNAMES:case m.EXTEND_LEASE:return t.jsx("h1",{className:"flex white",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case m.BUY_RECORD:return"Review your Purchase";default:return}}function ge(){var R;const e=H(),[{ioTicker:s,arioContract:f,ioProcessId:d,aoNetwork:y,aoClient:g}]=X(),[{arnsEmitter:u},S]=$(),[{walletAddress:l,wallet:n}]=G(),[{workflowName:a,interactionType:p,transactionData:r,interactionResult:o},E]=q(),I=z(),[i,T]=x.useState(),[c,N]=x.useState(_(p)),[w,C]=x.useState(D({workflowName:a})),[A,k]=x.useState(j({workflowName:a,ioTicker:s}));x.useEffect(()=>{if(!r&&!a){e("/");return}T(J({interactionType:p,transactionData:{...r,deployedTransactionId:o==null?void 0:o.id}})),k(j({workflowName:a,ioTicker:s})),N(_(p)),C(D({workflowName:a}))},[r,o,a,p,l]);async function U(){try{if(!(f instanceof Z))throw new Error("Wallet must be connected to dispatch transactions.");if(!r||!a)throw new Error("Transaction data is missing");if(!l)throw new Error("Wallet address is missing");await ne({arioContract:f,workflowName:a,payload:r,owner:l,processId:d,dispatch:E,signer:n==null?void 0:n.arconnectSigner,ao:g,scheduler:y.SCHEDULER}),e("/transaction/complete")}catch(W){h.emit("error",W)}finally{l&&ee({emitter:u,dispatch:S,ioProcessId:d,walletAddress:l})}}return i?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:I?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[c&&c.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"20px",width:"100%"},children:t.jsx(ae,{stage:3,stages:c})}):t.jsx(t.Fragment,{}),typeof w=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"50px 0px",borderTop:c!=null&&c.length?"solid 1px var(--text-faded)":""},children:w}):w,t.jsx(te,{...i,bordered:!0,compact:!0,overrides:{...i.overrides,targetId:(R=r==null?void 0:r.targetId)==null?void 0:R.toString()}}),t.jsx(se,{feeWrapperStyle:{alignItems:"center",justifyContent:"center",height:"100%"},fee:{[s]:r==null?void 0:r.interactionPrice},info:A&&t.jsx("div",{children:t.jsx(re,{wrapperStyle:{padding:"10px",fontSize:"14px",alignItems:"center"},customIcon:t.jsx(Q,{width:"20px",fill:"var(--accent)"}),text:A})})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx(V,{onNext:()=>U(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx(K,{loading:!0,message:"Loading transaction data..."})}export{ge as default};
//# sourceMappingURL=TransactionReview-0f05356a.js.map
