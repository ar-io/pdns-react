import{u as xe,a as fe,b as ge,c as pe,d as he,e as be,r as o,A as N,g as me,D as Se,f as Te,h as Ne,j as e,C as ve,S as ye,P as Ee,T as Ie,m as z,i as _,L as Ae,k as Ce,l as Re,n as je,V as we,o as _e,p as De,M as U,q as Oe,s as B,U as ke,t as u,v as Le,I as W,w as D,x as Me,y as O,z as Pe,B as Ve}from"./index-62274315.js";import{S as Fe,a as X,T as ze,A as Ue,R as Be}from"./RemoveControllerModal-e8da614e.js";import{T as We,S as Xe}from"./TransactionSuccessCard-845d8949.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},v=new Error().stack;v&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[v]="0e2efc0e-fb66-4f71-9952-1a970e6f6101",n._sentryDebugIdIdentifier="sentry-dbid-0e2efc0e-fb66-4f71-9952-1a970e6f6101")}catch{}})();function Ke(){const{id:n}=xe(),v=fe(),h=ge(),$=pe(),[{arweaveDataProvider:b}]=he(),[{walletAddress:f}]=be(),[i,Y]=o.useState(),[G,H]=o.useState(),[x,m]=o.useState(),[g,S]=o.useState(),[K,q]=o.useState([]),[k,L]=o.useState(!0),[Z,y]=o.useState(!1),[J,E]=o.useState(!1),[Q,I]=o.useState(!1),[R,ee]=o.useState([]),[te,c]=o.useState(!1),[d,T]=o.useState(),[ae,p]=o.useState(),[j,M]=o.useState(),ne=["name","ticker","targetID","ttlSeconds"];o.useEffect(()=>{if(!n||!f){h("/manage/ants");return}const a=new N(n);se(f,a)},[n,j]);async function se(a,t){var l,r;try{L(!0);const[s,w,re,oe]=await Promise.all([b.buildANTContract(t),b.getTransactionStatus(t).then(A=>A[t.toString()].confirmations),b.getPendingContractInteractions(t),b.getRecords({filters:{contractTxId:[t]}})]);if(!s.isValid())throw Error("Invalid ANT contract");const V=Object.keys(oe),F={status:w??0,contractTxId:t.toString(),associatedNames:V.length?V.join(", "):"N/A",undernames:me(s.records).toString(),name:s.name??"N/A",ticker:s.ticker??"N/A",owner:s.owner??"N/A",controllers:s.controllers.join(", ")??"N/A",targetID:((l=s.getRecord("@"))==null?void 0:l.transactionId)??"N/A",ttlSeconds:((r=s.getRecord("@"))==null?void 0:r.ttlSeconds)??Se},le=Object.keys(F).reduce((A,C,de)=>{const ce=F[C],ue={attribute:C,value:ce,editable:ne.includes(C),key:de,interactionType:Te(C)};return A.push(ue),A},[]);ee(re),Y(s),H(s.name??n),q(le),L(!1)}catch(s){Ne.emit("error",s),h("/manage/ants",{state:$.pathname})}}function P(a){var l,r,s;if(!a.isValid||!a.interactionType||!i)return;const t=a.interactionType===W.SET_TARGET_ID?D(a.interactionType,["@",g.toString(),((l=i.getRecord("@"))==null?void 0:l.ttlSeconds)??U]):a.interactionType===W.SET_TTL_SECONDS?D(a.interactionType,["@",(s=(r=i.getRecord("@"))==null?void 0:r.transactionId)!=null&&s.length?i.getRecord("@").transactionId:Me,+g]):D(a.interactionType,g.toString());if(t&&a.interactionType&&n){const w={...t,assetId:n};T(a.interactionType),p(w),c(!0)}}function ie(a,t){switch(t.attribute){case"ttlSeconds":return{[O.VALID_TTL]:{fn:Ve}};case"name":case"ticker":return{[O.VALID_ANT_NAME]:{fn:l=>Pe(l,B)}};case"targetID":case"controller":return{[O.ARWEAVE_ID]:{fn:l=>b.validateArweaveId(l)}};default:return{}}}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"page",style:{gap:"30px"},children:[j&&d?e.jsx(We,{txId:j,title:ve[d].successHeader,close:()=>{M(void 0),T(void 0)}}):e.jsx(e.Fragment,{}),e.jsx("div",{className:"flex-row flex-space-between",children:e.jsxs("h2",{className:"flex white center",style:{gap:"15px"},children:[e.jsx(ye,{width:"24px",height:"24px",fill:"var(--text-white)"}),G??n]})}),e.jsx("div",{className:"flex-row center",children:k?e.jsx("div",{className:"flex",style:{padding:"10%"},children:e.jsx(Ee,{loading:k,message:"Loading ANT data, please wait."})}):e.jsx(Ie,{showHeader:!1,style:{width:"100%"},onRow:a=>({className:a.attribute===x?"active-row":""}),scroll:{x:!0},pagination:!1,prefixCls:"manage-ant-table",columns:[{title:"",dataIndex:"attribute",key:"attribute",align:"left",width:v?"0px":"20%",className:"grey whitespace-no-wrap",render:a=>`${z(a)}:`},{title:"",dataIndex:"value",key:"value",align:"left",width:"70%",className:"white",render:(a,t)=>{const l=t.attribute===x;return t.attribute==="status"&&R?e.jsx(_,{placement:"right",title:R.map((r,s)=>e.jsxs(Ae,{className:"link white text underline",to:`https://viewblock.io/arweave/tx/${r.id}`,target:"_blank",children:["There is a pending transaction modifying this field.",e.jsx(Ce,{height:12,width:12,fill:"var(--text-white)"})]},"interaction-"+s)),showArrow:!0,overlayStyle:{maxWidth:"fit-content"},children:R.length?e.jsx(je,{height:20,width:20,fill:"var(--accent)"}):e.jsx(Re,{confirmations:+a})}):t.attribute==="undernames"?e.jsxs("span",{className:"flex center",style:{justifyContent:"flex-start",gap:"10px"},children:[a,e.jsx(Fe,{width:"20px",height:"20px",fill:"var(--text-grey)"})]}):t.editable?e.jsx(e.Fragment,{children:e.jsx(we,{customPattern:t.attribute==="targetID"?_e:t.attribute==="ttlSeconds"?De:void 0,catchInvalidInput:!0,showValidationIcon:t.attribute==x&&!!g,onPressEnter:()=>P(t),showValidationOutline:!1,inputId:t.attribute+"-input",minNumber:U,maxNumber:Oe,onClick:()=>{x!==t.attribute&&(m(t.attribute),S(a))},inputClassName:"flex",wrapperCustomStyle:{position:"relative",boxSizing:"border-box"},inputCustomStyle:{width:"100%",overflow:"hidden",fontSize:"13px",outline:"none",color:"white",alignContent:"center",borderBottom:"none",boxSizing:"border-box",...l?{background:"var(--card-bg)",borderRadius:"var(--corner-radius)",border:"1px solid var(--text-faded)",padding:"15px"}:{border:"none",background:"transparent"}},disabled:x!==t.attribute,placeholder:`Enter a ${z(t.attribute)}`,value:x===t.attribute?g:t.value,setValue:r=>{t.attribute===x&&S(r??"")},validityCallback:r=>{t.isValid=r},validationPredicates:ie(g,t),maxCharLength:r=>t.attribute==="name"||t.attribute==="ticker"?r.length<=B:t.attribute==="ttlSeconds"?r.length<=7:t.attribute==="targetID"?r.length<=43:!1})}):a}},{title:"",dataIndex:"action",key:"action",width:"10%",align:"right",className:"white",render:(a,t)=>t.editable&&(i!=null&&i.getOwnershipStatus(f))?e.jsx(e.Fragment,{children:x!==t.attribute?e.jsx("button",{className:"button pointer hover",onClick:()=>{m(t.attribute),S(t.value)},style:{boxSizing:"border-box"},children:e.jsx(Xe,{style:{width:"16px",height:"16px",fill:"var(--text-grey)",boxSizing:"border-box"}})}):e.jsxs("span",{className:"flex flex-row",style:{boxSizing:"border-box",gap:"10px"},children:[e.jsx("button",{className:"button bold grey pointer hover",style:{padding:"6px",fontSize:"13px",boxSizing:"border-box"},onClick:()=>m(""),children:"Cancel"}),e.jsx("button",{className:"button-primary hover",style:{padding:"9px 12px",fontSize:"13px",boxSizing:"border-box"},onClick:()=>P(t),children:"Save"})]})}):t.attribute==="owner"&&(i==null?void 0:i.getOwnershipStatus(f))==="owner"?e.jsx("span",{className:"flex flex-right",children:e.jsx("button",{onClick:()=>y(!0),className:"button-secondary",style:{padding:"9px 12px",fontSize:"13px",boxSizing:"border-box",letterSpacing:"0.5px",fontWeight:500},children:"Transfer"})}):t.attribute==="controllers"&&(i==null?void 0:i.getOwnershipStatus(f))==="owner"?e.jsx(_,{open:void 0,placement:"bottomRight",color:"var(--card-bg)",autoAdjustOverflow:!0,arrow:!1,overlayInnerStyle:{width:"fit-content",border:"1px solid var(--text-faded)",padding:"9px 12px"},overlayStyle:{width:"fit-content"},trigger:"click",title:e.jsxs("div",{className:"flex-column flex",style:{gap:"10px"},children:[e.jsx("button",{className:"flex flex-right white pointer button",onClick:()=>E(!0),children:"Add Controller"}),e.jsx("button",{className:"flex flex-right white pointer button",onClick:()=>I(!0),children:"Remove Controller"})]}),children:e.jsx(X,{width:"18px",height:"18px",fill:"var(--text-grey)",className:"pointer"})}):t.attribute==="undernames"?e.jsx(_,{placement:"bottomRight",color:"var(--card-bg)",autoAdjustOverflow:!0,arrow:!1,overlayInnerStyle:{width:"fit-content",border:"1px solid var(--text-faded)",padding:"9px 12px"},overlayStyle:{width:"fit-content"},trigger:"click",title:e.jsxs("div",{className:"flex-column flex",style:{gap:"10px"},children:[e.jsx("button",{className:"flex flex-right white pointer button",onClick:()=>h(`/manage/ants/${n}/undernames`),children:"Manage"}),i!=null&&i.getOwnershipStatus(f)?e.jsx("button",{className:"flex flex-right white pointer button",onClick:()=>{const l=new URLSearchParams({modal:ke.CREATE});h(encodeURI(`/manage/ants/${n}/undernames?${l.toString()}`))},children:"Add Undername"}):e.jsx(e.Fragment,{})]}),children:e.jsx(X,{width:"18px",height:"18px",fill:"var(--text-grey)",className:"pointer"})}):a}],dataSource:K})})]}),Z&&n?e.jsx(ze,{closeModal:()=>y(!1),antId:new N(n),payloadCallback:a=>{p(a),T(u.TRANSFER),c(!0),y(!1)}}):e.jsx(e.Fragment,{}),J&&n?e.jsx(Ue,{closeModal:()=>E(!1),antId:new N(n),payloadCallback:a=>{p(a),T(u.SET_CONTROLLER),c(!0),E(!1)}}):e.jsx(e.Fragment,{}),Q&&n?e.jsx(Be,{closeModal:()=>I(!1),antId:new N(n),payloadCallback:a=>{p(a),T(u.REMOVE_CONTROLLER),c(!0),I(!1)}}):e.jsx(e.Fragment,{}),te&&d&&n?e.jsx(Le,{interactionType:d,payload:ae,close:()=>{c(!1),p(void 0),m(void 0),S(void 0)},cancel:()=>{if(d===u.TRANSFER){y(!0),c(!1);return}if(d===u.SET_CONTROLLER){E(!0),c(!1);return}if(d===u.REMOVE_CONTROLLER){I(!0),c(!1);return}c(!1),p(void 0),m(void 0),S(void 0)},cancelText:d===u.TRANSFER||d===u.SET_CONTROLLER||d===u.REMOVE_CONTROLLER?"Back":"Cancel",setDeployedTransactionId:a=>M(a),assetId:new N(n)}):e.jsx(e.Fragment,{})]})}export{Ke as default};
//# sourceMappingURL=ManageANT-ae14b8a8.js.map
