import{r as n,d as ae,A as $,g as ce,j as e,aR as de,bD as pe,aS as xe,bE as ue,b6 as fe,bC as he,bn as Y,bF as re,bG as ee,bH as te,bg as H,bI as ge,bJ as ve,c as be,u as we,a as ye,bK as Se,bL as Ne,bM as je,b8 as Ie,bN as y,bO as ne,bP as ke,bQ as Te,bR as oe,bS as ie,bT as Ee,bU as Ae,bV as Re,bW as Ce}from"./index-9570aef0.js";import{C as Pe,T as Le}from"./TransactionCost-2a718ca9.js";import{P as De}from"./Pagination-4feb36e3.js";import{S as Fe}from"./StepProgressBar-7ec3bdfd.js";import"./useBreakpoint-6c7409e4.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},m=new Error().stack;m&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[m]="865a699f-c2cc-438d-4a67-fa616a3d6180",a._sentryDebugIdIdentifier="sentry-dbid-865a699f-c2cc-438d-4a67-fa616a3d6180")}catch{}})();function me(a){const[m,o]=n.useState(!1);return n.useEffect(()=>{if(!a)return;const g=document.getElementById(a);if(!g){console.error(`No element found with id: ${a}`);return}const c=()=>o(!0),d=()=>o(!1);return g.addEventListener("focus",c),g.addEventListener("blur",d),()=>{g.removeEventListener("focus",c),g.removeEventListener("blur",d)}},[a]),m}const le={isReserved:!1,reservedFor:void 0};function Be(a){const[{arweaveDataProvider:m}]=ae(),[o,g]=n.useState(!1),[c,d]=n.useState(le),[i,A]=n.useState(!1),[R,C]=n.useState(!1);n.useEffect(()=>{R||(a.length||x(),k(a))},[a]);function x(){g(!1),d(le),A(!1)}async function k(f){try{if(x(),C(!0),A(!1),!f.length)return x();const b=m.isDomainAvailable({domain:f}),S=m.isDomainReserved({domain:f}),[L,j]=await Promise.all([b,S]);g(L),d({...j,reservedFor:j.reservedFor?new $(j.reservedFor):void 0}),A(!0)}catch(b){console.error(b),x()}finally{C(!1)}}return{isAvailable:o,isReserved:c==null?void 0:c.isReserved,reservedFor:c==null?void 0:c.reservedFor,loading:R,validated:i}}function Oe({selectedTokenCallback:a}){var se;const[{arweaveDataProvider:m,antAoClient:o}]=ae(),[{walletAddress:g}]=ce(),[c,d]=n.useState(),[i,A]=n.useState(),[R,C]=n.useState(!1),[x,k]=n.useState(),[f,b]=n.useState(void 0),[S,L]=n.useState(!1),[j,O]=n.useState(!1),[M,D]=n.useState(void 0),G=me("name-token-input"),T=n.useRef(null),[E,I]=n.useState(1),P=3;n.useEffect(()=>{a(f?new $(f.id):void 0),I(1)},[f]),n.useEffect(()=>{if(T.current)return document.addEventListener("click",F),()=>{document.removeEventListener("click",F)}},[T]);function F(t){T.current&&t.target!==T.current&&!T.current.contains(t.target)&&(d(""),O(!1),k(void 0),I(1))}async function J(t,u=[]){try{if(C(!0),!t)throw new Error("No address provided");const r=[],p=u.length?await Promise.all(u.map(async s=>{try{const h=ee.init({process:new te({processId:s.toString(),ao:o})}),_=await h.getInfo();if(!h||!_)throw new Error("Unable to get contract");return D(!0),s}catch(h){H.emit("error",h)}})).then(s=>s.filter(h=>!!h)):[];if(!r.length&&!p.length)return;const v=r.concat(p),w=await m.getRecords({filters:{processId:v}}),N=await Promise.all(v.map(async s=>{const h=ee.init({process:new te({processId:s.toString(),ao:o})}),_=Object.keys(w).reduce((U,Z)=>(w[Z].processId===s.toString()&&(U[Z]=w[Z]),U),{}),[Q,X,q,K]=await Promise.all([h.getOwner(),h.getControllers(),h.getTicker(),h.getName()]).catch(()=>{throw new Error("Unable to get contract details")});return{processId:s,names:_,owner:Q,controllers:X,ticker:q,name:K}})).then(s=>s.filter(h=>!!h));if(!N.length)throw new Error("Unable to get details for Name Tokens");const B=N.reduce(async(s,h)=>{const{processId:_,owner:Q,controllers:X,name:q,ticker:K,names:U}=h;return{...s,[_.toString()]:{owner:Q,controllers:X,name:q,ticker:K,names:Object.keys(U)}}},{});if(A(await B),p.length){const s=B[p[0].toString()];b({name:s==null?void 0:s.name,ticker:s==null?void 0:s.ticker,id:p[0].toString(),names:(s==null?void 0:s.names)??[]})}}catch(r){H.emit("error",r)}finally{C(!1),I(1)}}function z(t){try{if(L(!0),D(void 0),!t){d("");return}if(d(t),!i)throw new Error("No Name Tokens Found");const u=Object.keys(i).filter(r=>{const{owner:p,controllers:v,name:w,ticker:N}=i[r];return[p,v,w,N,r].some(s=>s&&s.toString().toLowerCase().includes(t.toLowerCase()))}).map(r=>{const{name:p,ticker:v,names:w}=i[r];return{id:r,name:p??"",ticker:v??"",names:w}}).filter(r=>!!r);if(!u.length)throw new Error("No ANT tokens found for that search");k(u)}catch{k(void 0)}finally{L(!1),I(1)}}function l({id:t,name:u,ticker:r,names:p}){try{if(d(""),k(void 0),t===void 0)throw new Error(`No ID provided for ${u??r??""}`);b({id:t,name:u??"",ticker:r??"",names:p}),a(new $(t)),I(1)}catch(v){H.emit("error",v)}finally{O(!1)}}const W=(t,u,r)=>{if(i&&!(u==="next"||u==="prev"))return u==="page"?e.jsx("span",{className:"flex flex-row hover center",style:{color:E==t?"white":"var(--text-grey)",width:"32px"},children:t}):r};function V(t){I(t)}return e.jsxs("div",{ref:T,className:"flex flex-column radius",style:{position:"relative",height:"fit-content",maxHeight:"400px",border:G||j?"1px solid var(--text-white)":"1px solid var(--text-faded)",gap:0,boxSizing:"border-box"},children:[e.jsxs("div",{className:"name-token-input-wrapper",style:{borderBottom:"1px solid var(--text-faded)"},children:[e.jsx(de,{inputId:"name-token-input",onClick:()=>O(!0),showValidationIcon:!0,setValue:t=>z(t),value:c??"",maxCharLength:pe,placeholder:f?(se=f.name)!=null&&se.length?f.name:f.id:"Add an Arweave Name Token (ANT)",validationPredicates:{[xe.ARWEAVE_ID]:{fn:t=>m.validateArweaveId(t)}},validityCallback:t=>t,wrapperCustomStyle:{width:"100%",hieght:"45px",borderRadius:"0px",backgroundColor:"var(--card-bg)",boxSizing:"border-box",paddingLeft:"10px"},inputClassName:`white ${f?"name-token-input-selected":"name-token-input"}`}),e.jsx("span",{className:`flex flex-row text grey flex-center ${f?"bold":""} hover`,style:{width:"fit-content",height:"fit-content",wordBreak:"keep-all"},children:R||S?e.jsx(ue,{size:20,color:"var(--text-white)"}):c&&M===!1?e.jsx(e.Fragment,{}):c&&fe(c)&&!Object.keys(i??[]).includes(c)?e.jsx("button",{className:"outline-button flex flex-row center pointer",style:{borderRadius:"50px",width:"fit-content",padding:"3px 6px",fontSize:"12px",minWidth:"fit-content",border:"1px solid var(--text-grey)"},onClick:()=>{J(g,[new $(c)])},children:"Import"}):f?e.jsxs("button",{className:"outline-button flex flex-row center pointer",style:{gap:"3px",borderRadius:"50px",width:"fit-content",padding:"3px 7px",fontSize:"12px",minWidth:"fit-content",border:"1px solid var(--text-grey)"},onClick:()=>{b(void 0),a(void 0)},children:[e.jsx(he,{width:"13px",height:"13px"}),"Remove"]}):e.jsx(Y,{message:"For advanced use cases only, you can register this name with a custom ANT by entering its Process ID."})})]}),i&&j?e.jsxs("div",{className:"flex flex-column",style:{alignItems:"flex-start",justifyContent:"flex-start",gap:0,height:"fit-content",width:"100%",backgroundColor:"var(--card-bg)",boxSizing:"border-box",zIndex:10},children:[c&&!(x!=null&&x.length)?e.jsx("span",{className:"text-large center",style:{color:"#444547",margin:"auto",height:"50px"},children:"No Results"}):x?x.slice(Math.max((E-1)*P,0),E*P).map((t,u)=>{var r;if(t)return e.jsxs("button",{className:"name-token-item pointer",onClick:()=>{l({id:t.id,name:t.name??"",ticker:t.ticker??"",names:t.names??[]})},children:[t.name&&t.ticker?`${t.name.slice(0,20)} (${t.ticker}) - ${t.id}`:t.id,(r=t.names)!=null&&r.length?e.jsx(Y,{icon:e.jsx(re,{width:20,height:20,fill:"var(--text-grey)"}),message:e.jsx("div",{className:"flex flex-column",style:{padding:"5px",gap:"5px",boxSizing:"border-box"},children:t.names.map(p=>e.jsx("span",{children:p},p))})},u):e.jsx(e.Fragment,{})]},u)}):Object.entries(i).slice(Math.max((E-1)*P,0),E*P).map((t,u)=>{if(!t)return;const[r,p]=t,{name:v,ticker:w,names:N}=p;return e.jsxs("button",{className:"name-token-item pointer",onClick:()=>{l({id:r,name:v??"",ticker:w??"",names:N??[]})},children:[v&&w?`${v.slice(0,20)} ${v.length>20?"...":""} (${w}) - ${r}`:r,N!=null&&N.length?e.jsx(Y,{icon:e.jsx(re,{width:20,height:20,fill:"var(--text-grey)"}),message:e.jsx("div",{className:"flex flex-column",style:{padding:"5px",boxSizing:"border-box"},children:N.map(B=>e.jsx("span",{children:B},B))})}):e.jsx(e.Fragment,{})]},u)}),e.jsxs("div",{className:"custom-next-pagination flex flex-column",style:{padding:"10px 25px",boxSizing:"border-box",width:"100%",justifyContent:"flex-start"},children:[i.length||x!=null&&x.length||!c?e.jsx(De,{total:Object.keys(i).length&&!x?Object.keys(i).length:x?x.length:0,itemRender:W,showPrevNextJumpers:!0,showSizeChanger:!1,showQuickJumper:!1,onChange:V,current:E,defaultPageSize:P}):e.jsx(e.Fragment,{})," "]})]}):e.jsx(e.Fragment,{})]})}function Ue(){const[{domain:a,leaseDuration:m,registrationType:o,antID:g,targetId:c},d]=ge(),{data:i}=ve({intent:"Buy-Name",name:a,type:o,years:m}),[{arweaveDataProvider:A,arioTicker:R,arioProcessId:C,antAoClient:x}]=ae(),[{walletAddress:k,balances:f}]=ce(),[,b]=be(),{name:S}=we(),{loading:L}=Be(S??a),[j,O]=n.useState(),M=me("target-id-input"),D=ye(),[G,T]=Se(),[E,I]=n.useState(!1),[P,F]=n.useState(!1);n.useEffect(()=>{if(G.get("redirect")&&S){if(!f[R])return;T(),z();return}},[f]),n.useEffect(()=>{S&&a!==S&&d({type:"setDomainName",payload:S})},[S,a]);async function J(l){if(!l){d({type:"setANTID",payload:void 0});return}if(d({type:"setANTID",payload:l}),!ee.init({process:new te({processId:l.toString(),ao:x})}))throw new Error("Contract not found")}if(!o)return e.jsx(ue,{size:80});async function z(){try{if(!k){const V=new URLSearchParams({redirect:"true"});D("/connect",{state:{to:`/register/${a}?${V.toString()}`,from:`/register/${a}`}});return}if(F(!0),E)throw new Ne("Please fix the errors above before continuing.")}catch(V){H.emit("error",V),F(!1);return}finally{F(!1)}const W={name:a&&je().test(a)?Ie(a):a,processId:(g==null?void 0:g.toString())??"atomic",years:o===y.LEASE?m:void 0,type:o,targetId:c};b({type:"setTransactionData",payload:{assetId:C,functionName:"buyRecord",...W,interactionPrice:i==null?void 0:i.tokenCost}}),b({type:"setInteractionType",payload:ne.BUY_RECORD}),d({type:"reset"}),b({type:"setWorkflowName",payload:ne.BUY_RECORD}),D("/transaction/review",{state:`/register/${a}`})}return e.jsxs("div",{className:"page center",children:[e.jsx(ke,{message:"Loading Domain info, please wait.",loading:L}),e.jsxs("div",{className:"flex flex-column flex-center",style:{maxWidth:"900px",width:"100%",padding:"0px",gap:"50px",boxSizing:"border-box"},children:[e.jsx("div",{className:"flex flex-row flex-center",style:{paddingBottom:"20px",borderBottom:"solid 1px var(--text-faded)"},children:e.jsx(Fe,{stages:[{title:"Choose",description:"Pick a name",status:"finish"},{title:"Configure",description:"Registration Period",status:"process"},{title:"Confirm",description:"Review transaction",status:"wait"}],stage:1})}),e.jsxs("span",{className:"text-medium white center",style:{fontWeight:"500px",fontSize:"23px",gap:"15px"},children:[e.jsxs("span",{style:{color:"var(--success-green)"},children:[a," ",e.jsx("span",{className:"white",children:"is available!"})]})," ",e.jsx(Te,{style:{fontSize:"20px",color:"var(--success-green)"}})]}),e.jsxs("div",{className:"flex flex-column flex-center",children:[e.jsxs("div",{className:"flex flex-column flex-center",style:{width:"100%",height:"fit-content",gap:"15px"},children:[e.jsxs("div",{className:"flex flex-row flex-space-between",style:{gap:"25px"},children:[e.jsxs("button",{className:"flex flex-row center text-medium bold pointer",onClick:()=>d({type:"setRegistrationType",payload:y.LEASE}),style:{position:"relative",background:o===y.LEASE?"var(--text-white)":"",color:o===y.LEASE?"var(--text-black)":"var(--text-white)",border:"solid 2px var(--text-faded)",borderRadius:"var(--corner-radius)",height:"56px",borderBottomWidth:"0.5px"},children:["Lease"," ",o===y.LEASE?e.jsx("div",{style:{position:"absolute",bottom:"-6px",left:"50%",transform:"rotate(45deg)",width:"11px",height:"11px",background:"var(--text-white)"}}):e.jsx(e.Fragment,{})]}),e.jsxs("button",{className:"flex flex-row center text-medium bold pointer",style:{position:"relative",background:o===y.BUY?"var(--text-white)":"",color:o===y.BUY?"var(--text-black)":"var(--text-white)",border:"solid 2px var(--text-faded)",borderRadius:"var(--corner-radius)",height:"56px",borderBottomWidth:"0.5px"},onClick:()=>d({type:"setRegistrationType",payload:y.BUY}),children:["Buy"," ",o===y.BUY?e.jsx("div",{style:{position:"absolute",bottom:-6,left:"50%",transform:"rotate(45deg)",width:"11px",height:"11px",background:"var(--text-white)"}}):e.jsx(e.Fragment,{})]})]}),e.jsx("div",{className:"flex flex-column flex-center card",style:{width:"100%",minHeight:"0px",height:"fit-content",maxWidth:"unset",padding:"25px",boxSizing:"border-box",borderTopWidth:"0.2px",borderRadius:"var(--corner-radius)",justifyContent:"flex-start"},children:o===y.LEASE?e.jsx(Pe,{value:m,setValue:l=>{d({type:"setLeaseDuration",payload:l})},minValue:oe,maxValue:ie,valueStyle:{padding:"20px 120px"},valueName:m>1?"years":"year",detail:`Until ${Ee(Date.now()+m*365*24*60*60*1e3)}`,title:e.jsx("span",{className:"white",style:{padding:"0px 10px 10px 10px",fontWeight:"500"},children:`Registration period (between ${oe}-${ie} years)`})}):o===y.BUY?e.jsxs("div",{className:"flex flex-column flex-center",style:{gap:"1em"},children:[e.jsx("span",{className:"text-medium grey center",children:"Registration Period"}),e.jsx("span",{className:"text-medium white center",children:"Permanent"})]}):e.jsx(e.Fragment,{})})]}),e.jsxs("div",{className:"flex flex-column",style:{gap:"1em"},children:[e.jsx(Ae,{title:e.jsx("span",{className:"text-medium",children:"Advanced Options"}),children:e.jsxs("div",{className:"flex flex-column",style:{gap:"1em"},children:[e.jsxs("div",{className:"name-token-input-wrapper",style:{border:M||j?"solid 1px var(--text-white)":"solid 1px var(--text-faded)",position:"relative"},children:[e.jsx(de,{inputId:"target-id-input",value:j??"",setValue:l=>{O(l.trim()),fe(l.trim())&&d({type:"setTargetId",payload:new $(l.trim())}),l.trim().length===0&&I(!1)},wrapperCustomStyle:{width:"100%",hieght:"45px",borderRadius:"0px",backgroundColor:"var(--card-bg)",boxSizing:"border-box"},inputClassName:"white name-token-input",inputCustomStyle:{paddingLeft:"10px",background:"transparent"},maxCharLength:43,placeholder:"Arweave Transaction ID (Target ID)",validationPredicates:{[xe.ARWEAVE_ID]:{fn:l=>A.validateArweaveId(l)}},showValidationChecklist:!1,showValidationIcon:!0,validityCallback:l=>{I(!l)}}),e.jsx("span",{className:"flex flex-row text grey flex-center",style:{width:"fit-content",height:"fit-content",wordBreak:"keep-all"},children:e.jsx(Y,{message:"The Target ID is the Arweave Transaction ID that will be resolved at the root of this ArNS name"})})]}),e.jsx(Oe,{selectedTokenCallback:l=>J(l)})]})},"1"),e.jsx(Le,{ioRequired:!0,fee:{[R]:i!=null&&i.tokenCost?new Re(i.tokenCost).toARIO().valueOf():void 0},feeWrapperStyle:{alignItems:"center",justifyContent:"center",height:"100%"}}),e.jsx("div",{style:{marginTop:"0px"},children:e.jsx(Ce,{nextText:"Next",backText:"Back",onNext:P?void 0:z,onBack:()=>D("/",{state:`/register/${a}`}),customNextStyle:{width:"100px"}})})]})]})]})]})}export{Ue as default};
//# sourceMappingURL=Register-2385faa7.js.map
