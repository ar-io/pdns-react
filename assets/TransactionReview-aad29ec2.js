import{aU as h,bx as u,be as N,c0 as v,c1 as L,c2 as O,b4 as P,aZ as B,c3 as F,c4 as M,c5 as Y,j as t,a as H,aE as X,aW as G,aX as $,b as q,aF as z,r as m,c6 as _,c7 as Z,by as J,aM as K,bE as Q,c8 as V,c9 as ee}from"./index-7966dfcf.js";import{A as te}from"./ANTCard-88fd3d66.js";import{W as re}from"./WarningCard-d8e5b7dd.js";import{T as se}from"./TransactionCost-b6b7ac5a.js";import{S as ae}from"./StepProgressBar-ca6c1051.js";import{g as j}from"./transaction-descriptions-4d43ecce.js";import"./useBreakpoint-bdf6441f.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="e43c9e63-09db-4743-f3c1-9cf766bf3509",e._sentryDebugIdIdentifier="sentry-dbid-e43c9e63-09db-4743-f3c1-9cf766bf3509")}catch{}})();async function ne({payload:e,workflowName:a,owner:p,arioContract:d,processId:y,dispatch:g,signer:x,ao:E,scheduler:l=Y}){var r;let i;const n=setTimeout(()=>{h.emit("network:ao:congested",!0)},1e4);try{if(!d)throw new Error("ArIO provider is not defined");if(!x)throw new Error("signer is not defined");switch(g({type:"setSigning",payload:!0}),a){case u.BUY_RECORD:{const{name:s,type:S,years:I}=e;let o=e.processId;if(o==="atomic"){const c=e.state||L(p.toString(),(r=e.targetId)==null?void 0:r.toString());o=await O({state:c,signer:P(x),ao:E,scheduler:l,luaCodeTxId:B}),await F.init({signer:x,processId:M}).register({processId:o}).catch(w=>{h.emit("error",new Error(`Failed to register ANT process: ${w}. You may need to manually register the process`))})}const T=await d.buyRecord({name:N(s),type:S,years:I,processId:o});e.processId=o,i=T;break}case u.EXTEND_LEASE:i=await d.extendLease({name:N(e.name),years:e.years},v);break;case u.INCREASE_UNDERNAMES:i=await d.increaseUndernameLimit({name:N(e.name),increaseCount:e.qty},v);break;default:throw new Error(`Unsupported workflow name: ${a}`)}}catch(s){h.emit("error",s)}finally{g({type:"setSigning",payload:!1}),clearTimeout(n)}if(!i)throw new Error("Failed to dispatch ArIO interaction");const f={deployer:p.toString(),processId:y.toString(),id:i.id,type:"interaction",payload:e};return g({type:"setWorkflowName",payload:a}),g({type:"setInteractionResult",payload:f}),f}function D({workflowName:e,...a}){switch(e){case u.INCREASE_UNDERNAMES:case u.EXTEND_LEASE:return t.jsx("h1",{className:"flex white text-[2rem]",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case u.BUY_RECORD:return"Review your Purchase";default:return}}function ge(){var R;const e=H(),[{ioTicker:a,arioContract:p,ioProcessId:d,aoNetwork:y,aoClient:g}]=X(),[{arnsEmitter:x},E]=G(),[{walletAddress:l,wallet:i}]=$(),[{workflowName:n,interactionType:f,transactionData:r,interactionResult:s},S]=q(),I=z(),[o,T]=m.useState(),[c,b]=m.useState(_(f)),[w,C]=m.useState(D({workflowName:n})),[A,k]=m.useState(j({workflowName:n,ioTicker:a}));m.useEffect(()=>{if(!r&&!n){e("/");return}T(Z({interactionType:f,transactionData:{...r,deployedTransactionId:s==null?void 0:s.id}})),k(j({workflowName:n,ioTicker:a})),b(_(f)),C(D({workflowName:n}))},[r,s,n,f,l]),m.useEffect(()=>{s!=null&&s.id&&e("/transaction/complete")},[s,e]);async function U(){try{if(!(p instanceof V))throw new Error("Wallet must be connected to dispatch transactions.");if(!r||!n)throw new Error("Transaction data is missing");if(!l)throw new Error("Wallet address is missing");await ne({arioContract:p,workflowName:n,payload:r,owner:l,processId:d,dispatch:S,signer:i==null?void 0:i.contractSigner,ao:g,scheduler:y.SCHEDULER})}catch(W){h.emit("error",W)}finally{l&&ee({emitter:x,dispatch:E,ioProcessId:d,walletAddress:l})}}return o?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:I?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[c&&c.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"20px",width:"100%"},children:t.jsx(ae,{stage:3,stages:c})}):t.jsx(t.Fragment,{}),typeof w=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"50px 0px",borderTop:c!=null&&c.length?"solid 1px var(--text-faded)":""},children:w}):w,t.jsx(te,{...o,bordered:!0,compact:!0,overrides:{...o.overrides,targetId:(R=r==null?void 0:r.targetId)==null?void 0:R.toString()}}),t.jsx(se,{feeWrapperStyle:{alignItems:"center",justifyContent:"center",height:"100%"},fee:{[a]:r==null?void 0:r.interactionPrice},info:A&&t.jsx("div",{children:t.jsx(re,{wrapperStyle:{padding:"10px",fontSize:"14px",alignItems:"center"},customIcon:t.jsx(K,{width:"20px",fill:"var(--accent)"}),text:A})})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx(Q,{onNext:()=>U(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx(J,{loading:!0,message:"Loading transaction data..."})}export{ge as default};
//# sourceMappingURL=TransactionReview-aad29ec2.js.map
