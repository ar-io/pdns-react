import{y as _,b as L,c as C,d as k,a as M,r as i,aa as B,ak as b,al as y,M as F,g as O,f as w,bs as P,j as e,ap as U,B as Y,bt as $,as as T,ar as z,bu as W,au as X,A as V,ao as v,aw as q}from"./index-d31ce45d.js";import{S as m}from"./Info-394f522b.js";import{T as G}from"./TransactionCost-47f9ab29.js";import{C as H}from"./Counter-669b5cb3.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},l=new Error().stack;l&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[l]="da2df7bb-000e-4848-33c3-79924cf97182",n._sentryDebugIdIdentifier="sentry-dbid-da2df7bb-000e-4848-33c3-79924cf97182")}catch{}})();function ee(){const[{arweaveDataProvider:n,ioTicker:l}]=_(),[{walletAddress:u}]=L(),[,p]=C(),N=k(),x=M(),a=N.pathname.split("/").at(-2),[t,E]=i.useState(),[S,f]=i.useState(),[d,I]=i.useState(1),[s,j]=i.useState(0),[o,g]=i.useState(),[h,D]=i.useState(0);i.useEffect(()=>{if(!a){x("/manage/names");return}R(B(a))},[a]),i.useEffect(()=>{if(!t||!t.endTimestamp||!a)return;g(void 0),(async()=>{const r=await n.getPriceForInteraction({interactionName:q.EXTEND_RECORD,payload:{name:a,years:d}}).catch(()=>(w.emit("error",new Error("Unable to get price for extend lease")),-1));g(r)})()},[d,s,t,a]);async function R(c){try{const r=await n.getRecord({domain:c});if(!(r!=null&&r.type))throw new Error(`Unable to get record for ${c}`);if(f(r.type),E(r),!t.endTimestamp){f(b.BUY);return}const A=await n.getTokenBalance(u,y);D(A??0),j(Math.max(0,F-O(r.startTimestamp>t.endTimestamp?r.startTimestamp:r.startTimestamp*1e3,t.endTimestamp*1e3)))}catch(r){w.emit("error",r),await P(2e3),x("/manage/names")}}return!t||!a?e.jsx(U,{loading:!t,message:`Loading info for ${a}`}):!t.endTimestamp||S===b.BUY?e.jsx("div",{className:"page center",children:e.jsx(Y,{showClose:!1,cancelText:"Manage",body:e.jsxs("span",{className:"flex flex-column white center",style:{height:"100%"},children:["This domain is permanently registered and its lease cannot be extended.",e.jsx($,{domain:a})]})})}):e.jsx("div",{className:"page center",children:e.jsxs("div",{className:"flex flex-column",style:{maxWidth:"1000px"},children:[e.jsxs("div",{className:"flex flex-row center",style:{justifyContent:"space-between"},children:[e.jsx("h1",{className:"white",children:"Extend Lease"}),e.jsxs("div",{className:"flex flex-row center white",style:{border:"solid 1px var(--text-faded)",borderRadius:"var(--corner-radius)",gap:"8px",width:"fit-content",padding:"12px"},children:[e.jsx(m,{width:"22px",height:"22px",fill:"var(--text-grey)"}),"Expiring on ",T(t.endTimestamp*1e3)]})]}),e.jsxs("div",{className:"flex flex-column",style:{width:"100%",height:"100%",background:"var(--card-bg)",borderRadius:"var(--corner-radius)",padding:"30px",boxSizing:"border-box",position:"relative"},children:[s<1?e.jsx("div",{className:"flex flex-column center modal-container",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.5)",borderRadius:"var(--corner-radius)",zIndex:1},children:e.jsxs("div",{className:"flex flex-row center",style:{width:"fit-content",height:"fit-content",borderRadius:"var(--corner-radius)",border:"solid 1px var(--error-red)",background:"#1D1314",padding:"10px",boxSizing:"border-box",color:"var(--error-red)",gap:"10px"},children:[" ",e.jsx(m,{width:"24px",height:"24px",fill:"var(--error-red)"}),e.jsx("span",{className:"center",children:"Maximum lease extension reached"})]})}):e.jsx(e.Fragment,{}),e.jsx(H,{setValue:I,value:d,maxValue:s,minValue:z,valueName:d>1?"years":"year",valueStyle:{padding:"10px 80px"},detail:e.jsxs("span",{children:["until"," ",T(t.endTimestamp*1e3+d*W)]}),title:e.jsx("span",{className:"white",style:{padding:"0px 10px 10px 10px",fontWeight:"500"},children:`Extension Duration ( up to ${Math.max(1,s)} year${s>1?"s":""} )`})})]}),e.jsx(G,{fee:{[l]:o},ioRequired:!0}),e.jsx(X,{backText:"Cancel",nextText:"Continue",customNextStyle:{background:s<1&&"var(--text-grey)",color:s<1&&"var(--text-white)"},onBack:()=>{x(`/manage/names/${a}`)},onNext:!o||o<0?void 0:s>=1||o<=h?()=>{const c={name:a,years:d,contractTxId:new V(t.contractTxId),qty:o};p({type:"setInteractionType",payload:v.EXTEND_LEASE}),p({type:"setTransactionData",payload:{assetId:y.toString(),functionName:"extendRecord",...c,interactionPrice:o}}),p({type:"setWorkflowName",payload:v.EXTEND_LEASE}),x("/transaction/review",{state:`/manage/names/${a}/extend`})}:void 0,detail:o&&o>h&&s>0?e.jsxs("div",{className:"flex flex-row center",style:{width:"fit-content",height:"fit-content",borderRadius:"var(--corner-radius)",border:"solid 1px var(--error-red)",background:"#1D1314",padding:"8px",boxSizing:"border-box",color:"var(--error-red)",gap:"10px",whiteSpace:"nowrap",fontSize:"13px"},children:[" ",e.jsx(m,{width:"24px",height:"24px",fill:"var(--error-red)"}),e.jsx("span",{className:"center",children:"Insufficient funds."})]}):e.jsx(e.Fragment,{})})]})})}export{ee as default};
//# sourceMappingURL=ExtendLease-5c9f1c5d.js.map
