import{am as i,as as h,at as u,ah as p,au as A,av as B,A as S,aw as U,aj as N,ax as L,f as _,ay as P,j as t,a as W,y as M,b as F,c as Y,z as X,r as f,az as R,aA as q,an as H,W as G,ar as $,aB as z}from"./index-8036de61.js";import{S as J}from"./Info-e31c6880.js";import{T as K}from"./TransactionCost-22634ffc.js";import{S as Q}from"./StepProgressBar-ce0aa390.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="193db922-ba68-4cbd-54d7-544af2655e85",e._sentryDebugIdIdentifier="sentry-dbid-193db922-ba68-4cbd-54d7-544af2655e85")}catch{}})();async function V({payload:e,workflowName:a,arioContract:c,arweaveCompositeProvider:w,contractTxId:x,dispatch:d}){let n,s;try{if(!c)throw new Error("ArIO provider is not defined");switch(d({type:"setSigning",payload:!0}),a){case i.BUY_RECORD:{let o;e.contractTxId===p?e.targetId&&e.state&&(e.state.records["@"]={transactionId:e.targetId,ttlSeconds:A}):e.targetId&&(o=B({contractId:new S(e.contractTxId),input:{function:"setRecord",subDomain:"@",transactionId:e.targetId,ttlSeconds:A}}));const E=U(i.BUY_RECORD,e);n={id:e.contractTxId===p?await w.registerAtomicName({walletAddress:e.walletAddress,registryId:N,srcCodeTransactionId:new S(L),initialState:e.state,domain:e.name,type:e.type,years:e.years,qty:e.qty}):await w.writeTransaction({walletAddress:e.walletAddress,contractTxId:N,dryWrite:!0,payload:{function:u.BUY_RECORD,...E},tags:o,interactionDetails:{isBid:e.isBid?e.isBid:!1}}),owner:e.walletAddress},s=u.BUY_RECORD;break}case i.EXTEND_LEASE:n=await c.extendLease({domain:e.name,years:e.years},h),s=u.EXTEND_RECORD;break;case i.INCREASE_UNDERNAMES:n=await c.increaseUndernameLimit({domain:e.name,qty:e.qty},h),s=u.INCREASE_UNDERNAME_COUNT;break;default:throw new Error(`Unsupported workflow name: ${a}`)}}catch(o){_.emit("error",o)}finally{d({type:"setSigning",payload:!1})}if(!n)throw new Error("Failed to dispatch ArIO interaction");if(!s)throw new Error("Failed to set workflow name");const r={deployer:e.walletAddress.toString(),contractTxId:x.toString(),id:await n.id,payload:{...e,function:s},type:"interaction"};return await P.push(x.toString(),r),d({type:"setWorkflowName",payload:a}),d({type:"setInteractionResult",payload:r}),r}function y({workflowName:e,...a}){switch(e){case i.INCREASE_UNDERNAMES:return`Increasing your undernames is paid in ${a.ioTicker} tokens, and an Arweave network fee paid in AR tokens.`;case i.EXTEND_LEASE:case i.BUY_RECORD:return`This includes a registration fee (paid in ${a.ioTicker} tokens) and the Arweave network fee (paid in AR tokens).`;default:return}}function D({workflowName:e,...a}){switch(e){case i.INCREASE_UNDERNAMES:case i.EXTEND_LEASE:return t.jsx("h1",{className:"flex white",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case i.BUY_RECORD:return"Review your Purchase";default:return}}function ne(){const e=W(),[{ioTicker:a,arioContract:c,arnsContractId:w,arweaveDataProvider:x}]=M(),[{walletAddress:d}]=F(),[{workflowName:n,interactionType:s,transactionData:r,interactionResult:o},E]=Y(),m=X(),[T,v]=f.useState(),[l,b]=f.useState(R(s)),[g,C]=f.useState(D({workflowName:n})),[I,j]=f.useState(y({workflowName:n,ioTicker:a}));f.useEffect(()=>{!r&&!n&&e("/"),v(q({interactionType:s,transactionData:{...r,deployedTransactionId:o==null?void 0:o.id}})),j(y({workflowName:n,ioTicker:a})),b(R(s)),C(D({workflowName:n}))},[r,o,n,s,d]);async function k(){try{if(!(c instanceof z))throw new Error("Wallet must be connected to dispatch transactions.");if(!r||!n)throw new Error("Transaction data is missing");await V({arioContract:c,arweaveCompositeProvider:x,workflowName:n,payload:r,contractTxId:w,dispatch:E}),e("/transaction/complete")}catch(O){_.emit("error",O)}}return T?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:m?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[l&&l.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"30px",width:"100%"},children:t.jsx(Q,{stage:3,stages:l})}):t.jsx(t.Fragment,{}),typeof g=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"80px 0px",borderTop:l!=null&&l.length?"solid 1px var(--text-faded)":""},children:g}):g,t.jsx(G,{...T,bordered:!0,compact:!1}),t.jsx(K,{fee:{[a]:r==null?void 0:r.interactionPrice},info:I&&t.jsxs("div",{className:"flex flex-row flex-left",style:{gap:"10px",maxWidth:"50%",justifyContent:"flex-start",alignItems:"flex-start"},children:[t.jsx(J,{width:"20px",height:"20px",fill:"var(--text-grey)"}),t.jsx("span",{className:"flex flex-column flex-left grey text",style:{textAlign:"left",lineHeight:"1.5em"},children:I})]})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx($,{onNext:()=>k(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx(H,{loading:!0,message:"Loading transaction data..."})}export{ne as default};
//# sourceMappingURL=TransactionReview-a1e9b38f.js.map
