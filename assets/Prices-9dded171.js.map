{"version":3,"file":"Prices-9dded171.js","sources":["../../src/hooks/useDemandFactor.tsx","../../src/components/pages/Prices/Prices.tsx"],"sourcesContent":["import { useGlobalState } from '@src/state';\nimport { useQuery } from '@tanstack/react-query';\n\nexport function useDemandFactor() {\n  const [{ arioProcessId, arioContract }] = useGlobalState();\n  return useQuery({\n    queryKey: ['demand-factor', arioProcessId],\n    queryFn: async () => {\n      const demandFactor = await arioContract.getDemandFactor();\n\n      return demandFactor;\n    },\n    enabled: !!arioProcessId && !!arioContract?.getDemandFactor,\n    staleTime: 1000 * 60 * 3,\n  });\n}\n","import TableView from '@src/components/data-display/tables/TableView';\nimport { useDemandFactor } from '@src/hooks/useDemandFactor';\nimport {\n  camelToReadable,\n  formatARIOWithCommas,\n  lowerCaseDomain,\n} from '@src/utils';\nimport {\n  ARNS_NAME_REGEX_PARTIAL,\n  MAX_ARNS_NAME_LENGTH,\n} from '@src/utils/constants';\nimport eventEmitter from '@src/utils/events';\nimport { createColumnHelper } from '@tanstack/react-table';\nimport { useMemo, useState } from 'react';\n\ntype TableData = {\n  characters: number;\n  baseFee: number;\n  adjustedRegistrationFee: number;\n  renewalFee: number;\n  oneYearLeaseFee: number;\n  permabuyFee: number;\n  undernameFee: number;\n  permabuyUndernameFee: number;\n} & Record<string, any>;\n\nconst columnHelper = createColumnHelper<TableData>();\n\nconst minFees = new Array(MAX_ARNS_NAME_LENGTH - 12)\n  .fill(true)\n  .reduce((acc, _, index) => {\n    acc[index + 13] = 200;\n    return acc;\n  }, {});\n\nconst BASE_NAME_FEES: Record<number, number> = {\n  1: 1000000,\n  2: 200000,\n  3: 20000,\n  4: 10000,\n  5: 2500,\n  6: 1500,\n  7: 800,\n  8: 500,\n  9: 400,\n  10: 350,\n  11: 300,\n  12: 250,\n  ...minFees,\n};\n\nexport default function Prices() {\n  const { data: demandFactor, isLoading, error } = useDemandFactor();\n  const [domain, setDomain] = useState('');\n\n  const tableData = useMemo(() => {\n    if (!demandFactor) return [];\n    const newData = Object.entries(BASE_NAME_FEES).map(\n      ([characters, baseFee]) => {\n        const arf = baseFee * demandFactor;\n        const af = arf * 0.2;\n        const data: TableData = {\n          characters: Number(characters),\n          baseFee,\n          adjustedRegistrationFee: arf,\n          renewalFee: af,\n          oneYearLeaseFee: arf + af * 1,\n          permabuyFee: arf + af * 20,\n          undernameFee: baseFee * demandFactor * 0.001,\n          permabuyUndernameFee: baseFee * demandFactor * 0.005,\n        };\n        return data;\n      },\n    );\n    return newData;\n  }, [demandFactor, isLoading, error]);\n\n  const columns = [\n    'characters',\n    'oneYearLeaseFee',\n    'renewalFee',\n    'permabuyFee',\n    'undernameFee',\n    'permabuyUndernameFee',\n  ].map((key) => {\n    return columnHelper.accessor(key, {\n      id: key,\n      header: () => {\n        return <span className=\"\">{camelToReadable(key)} </span>;\n      },\n      cell: ({ row }) => {\n        const numVal = Number(row.getValue(key));\n        if (key === 'characters') return numVal.toString();\n        return formatARIOWithCommas(Number(numVal.toFixed(1)));\n      },\n    });\n  });\n\n  return (\n    <div className=\"page sm:px-10 lg:px-[100px]\">\n      <div className=\"flex justify-between w-full items-center\">\n        <h1 className=\"text-white text-3xl w-full\">Prices ($ARIO)</h1>{' '}\n        <span className=\"flex p-2 bg-foreground border border-dark-grey rounded text-white whitespace-nowrap\">\n          Demand Factor:{' '}\n          {isLoading ? 'Loading...' : error ? error.message : demandFactor}\n        </span>\n      </div>\n\n      <div className=\"flex w-full py-2 justify-between  items-center gap-5\">\n        <input\n          className=\"flex w-full p-2 bg-background border-b border-dark-grey outline-none text-white\"\n          placeholder=\"Enter an ArNS Name to see its fee\"\n          value={domain}\n          onChange={(e) => {\n            const trimmed = e.target.value.trim();\n            if (trimmed.length > MAX_ARNS_NAME_LENGTH) return;\n            if (!ARNS_NAME_REGEX_PARTIAL.test(lowerCaseDomain(trimmed))) {\n              eventEmitter.emit('error', {\n                name: 'Invalid ARNS name',\n                message: `${trimmed} is not a valid arns name`,\n              });\n              return;\n            }\n            setDomain(trimmed);\n          }}\n        />\n      </div>\n\n      <div className=\"flex flex-col size-full gap-2\">\n        <TableView\n          data={tableData}\n          columns={columns}\n          isLoading={false}\n          defaultSortingState={{ id: 'characters', desc: false }}\n          tableClass=\"border-[1px] border-dark-grey relative\"\n          paginationConfig={{ pageSize: 51 }}\n          headerClass=\"sticky absolute\"\n          bodyClass=\"scrollbar overflow-y-scroll\"\n          rowClass={(props) => {\n            const rowCharLength = props?.row?.getValue('characters');\n            if (props?.row !== undefined) {\n              return rowCharLength === lowerCaseDomain(domain).length\n                ? 'bg-primary-thin border-l-2 border-primary border-t-0'\n                : '';\n            }\n\n            return '';\n          }}\n          dataClass={(props) => {\n            if (props?.row !== undefined && props.row.getIsExpanded()) {\n              return 'border-t-[1px] border-dark-grey border-b-0';\n            }\n\n            return '';\n          }}\n        />\n      </div>\n    </div>\n  );\n}\n"],"names":["useDemandFactor","arioProcessId","arioContract","useGlobalState","useQuery","columnHelper","createColumnHelper","minFees","MAX_ARNS_NAME_LENGTH","acc","_","index","BASE_NAME_FEES","Prices","demandFactor","isLoading","error","domain","setDomain","reactExports","tableData","characters","baseFee","arf","af","columns","key","jsxRuntimeExports","camelToReadable","row","numVal","formatARIOWithCommas","trimmed","ARNS_NAME_REGEX_PARTIAL","lowerCaseDomain","eventEmitter","TableView","props","rowCharLength","_a"],"mappings":"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"}