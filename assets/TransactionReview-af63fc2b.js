import{al as p,l as h,as as I,at as _,au as W,e as b,j as t,a as k,x as C,$ as P,b as B,y as O,r as g,av as S,aw as L,am as U,P as M,G as F,ar as Y,ax as G}from"./index-6123a64c.js";import{W as H}from"./WarningCard-2b6b5ad2.js";import{T as X}from"./TransactionCost-5a11f36b.js";import{S as $}from"./StepProgressBar-d5c45363.js";import{g as T}from"./transaction-descriptions-89b39c81.js";import"./useBreakpoint-c8c70551.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="78686c44-5a28-4ece-1054-9ca38090e61c",e._sentryDebugIdIdentifier="sentry-dbid-78686c44-5a28-4ece-1054-9ca38090e61c")}catch{}})();async function q({payload:e,workflowName:a,owner:f,arioContract:d,processId:u,dispatch:i,signer:r}){let n;try{if(!d)throw new Error("ArIO provider is not defined");if(!r)throw new Error("signer is not defined");switch(i({type:"setSigning",payload:!0}),a){case p.BUY_RECORD:{const{name:o,type:m,years:x}=e;let c=e.processId;c==="atomic"&&(c=await _({state:e.state,signer:W(r)}));const w=await d.buyRecord({name:h(o),type:m,years:x,processId:c});e.processId=c,n=w;break}case p.EXTEND_LEASE:n=await d.extendLease({name:h(e.name),years:e.years},I);break;case p.INCREASE_UNDERNAMES:n=await d.increaseUndernameLimit({name:h(e.name),increaseCount:e.qty},I);break;default:throw new Error(`Unsupported workflow name: ${a}`)}}catch(o){b.emit("error",o)}finally{i({type:"setSigning",payload:!1})}if(!n)throw new Error("Failed to dispatch ArIO interaction");const s={deployer:f.toString(),processId:u.toString(),id:n.id,type:"interaction",payload:e};return i({type:"setWorkflowName",payload:a}),i({type:"setInteractionResult",payload:s}),s}function N({workflowName:e,...a}){switch(e){case p.INCREASE_UNDERNAMES:case p.EXTEND_LEASE:return t.jsx("h1",{className:"flex white",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case p.BUY_RECORD:return"Review your Purchase";default:return}}function ee(){const e=k(),[{ioTicker:a,arioContract:f,ioProcessId:d}]=C(),[{walletAddress:u,wallet:i}]=P(),[{workflowName:r,interactionType:n,transactionData:s,interactionResult:o},m]=B(),x=O(),[c,w]=g.useState(),[l,v]=g.useState(S(n)),[y,j]=g.useState(N({workflowName:r})),[E,R]=g.useState(T({workflowName:r,ioTicker:a}));g.useEffect(()=>{if(!s&&!r){e("/");return}w(L({interactionType:n,transactionData:{...s,deployedTransactionId:o==null?void 0:o.id}})),R(T({workflowName:r,ioTicker:a})),v(S(n)),j(N({workflowName:r}))},[s,o,r,n,u]);async function A(){try{if(!(f instanceof G))throw new Error("Wallet must be connected to dispatch transactions.");if(!s||!r)throw new Error("Transaction data is missing");if(!u)throw new Error("Wallet address is missing");await q({arioContract:f,workflowName:r,payload:s,owner:u,processId:d,dispatch:m,signer:i==null?void 0:i.arconnectSigner}),e("/transaction/complete")}catch(D){b.emit("error",D)}}return c?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:x?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[l&&l.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"20px",width:"100%"},children:t.jsx($,{stage:3,stages:l})}):t.jsx(t.Fragment,{}),typeof y=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"50px 0px",borderTop:l!=null&&l.length?"solid 1px var(--text-faded)":""},children:y}):y,t.jsx(M,{...c,bordered:!0,compact:!0}),t.jsx(X,{feeWrapperStyle:{alignItems:"center",justifyContent:"center",height:"100%"},fee:{[a]:s==null?void 0:s.interactionPrice},info:E&&t.jsx("div",{children:t.jsx(H,{wrapperStyle:{padding:"10px",fontSize:"14px",alignItems:"center"},customIcon:t.jsx(F,{width:"20px",fill:"var(--accent)"}),text:E})})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx(Y,{onNext:()=>A(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx(U,{loading:!0,message:"Loading transaction data..."})}export{ee as default};
//# sourceMappingURL=TransactionReview-af63fc2b.js.map
