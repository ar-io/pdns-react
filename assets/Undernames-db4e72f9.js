import{r as n,c5 as Y,c6 as B,aK as J,c7 as K,c8 as M,c9 as O,e as _,j as e,aN as Q,aP as U,ca as q,aQ as P,cb as ee,cc as te,T as ae,a_ as se,aM as H,aZ as k,aY as ne,cd as re,aJ as ie,b1 as G,b as le,bf as oe,a$ as D,aT as ce,aU as T,ce as de,b8 as F,b9 as W,bc as ue,c1 as xe,aO as z,cf as he,cg as fe,ch as pe,ci as me,cj as ge,A as $,aV as be,ck as we,b4 as ye,a as ve,u as Ne,cl as je,cm as Se}from"./index-4cc8c479.js";import{W as Ce}from"./WarningCard-40cd5c23.js";import{u as Te}from"./useDomainInfo-e1056820.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},o=new Error().stack;o&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[o]="db492d30-3cfc-41af-19ff-1be02fbfbde5",r._sentryDebugIdIdentifier="sentry-dbid-db492d30-3cfc-41af-19ff-1be02fbfbde5")}catch{}})();const Ee=r=>n.createElement("svg",{width:"current",height:"current",viewBox:"0 0 24 24",fill:"current",xmlns:"http://www.w3.org/2000/svg",...r},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21 6.0014H16V4.3314C15.9512 2.9985 14.833 1.95641 13.5 2.0014H10.5C9.16696 1.95642 8.04885 2.9985 8 4.3314V6.0014H3C2.44771 6.0014 2 6.44912 2 7.0014C2 7.55369 2.44771 8.0014 3 8.0014H4V19.0014C4 20.6583 5.34315 22.0014 7 22.0014H17C18.6569 22.0014 20 20.6583 20 19.0014V8.0014H21C21.5523 8.0014 22 7.55369 22 7.0014C22 6.44912 21.5523 6.0014 21 6.0014ZM10 4.33C10 4.17 10.21 4 10.5 4H13.5C13.79 4 14 4.17 14 4.33V6H10V4.33ZM17 20C17.5523 20 18 19.5523 18 19V8H6V19C6 19.5523 6.44771 20 7 20H17ZM9 17C9.55229 17 10 16.5523 10 16V12C10 11.4477 9.55229 11 9 11C8.44771 11 8 11.4477 8 12V16C8 16.5523 8.44771 17 9 17ZM16 16C16 16.5523 15.5523 17 15 17C14.4477 17 14 16.5523 14 16V12C14 11.4477 14.4477 11 15 11C15.5523 11 16 11.4477 16 12V16Z",fill:"current"}));/**
 * @license lucide-react v0.438.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=Y("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function De({antId:r,closeModal:o,payloadCallback:l}){const{data:t}=B(),u=J(),x=n.useRef(null),h=n.useRef(null),g=n.useRef(null),[i,b]=n.useState(""),[p,S]=n.useState(K.toString()),[y,C]=n.useState(M),[j,R]=n.useState({}),[E,A]=n.useState(O);n.useEffect(()=>{var a,d;if(t){const v=(a=t==null?void 0:t.items)==null?void 0:a.reduce((N,V)=>(N[V.name]=V,N),{});w({arnsRecords:v})}(d=g.current)==null||d.focus()},[r.toString()]);async function w({arnsRecords:a}){try{R(a);const d=Object.keys(a).length?Math.min(...Object.keys(a).map(v=>v.length)):0;A(O-d)}catch(d){_.emit("error",d)}}function L(){l({subDomain:i,transactionId:p,ttlSeconds:y})}function m(a,d){return Object.keys(d).filter(v=>a.length+v.length>O)}return e.jsx("div",{className:"modal-container",style:u?{padding:"none"}:{},children:e.jsx(Q,{title:e.jsx("h2",{className:"white text-xl",children:"Add Undername"}),body:e.jsx("form",{children:e.jsx("div",{className:"flex flex-column",style:{fontSize:"14px",width:"500px"},children:e.jsxs("div",{className:"flex flex-column",style:{paddingBottom:"30px"},children:[e.jsxs("div",{className:"flex flex-column",style:{gap:"15px"},children:[e.jsx("span",{className:"grey",children:"Undername:"}),e.jsxs("span",{className:"flex flex-row",style:{position:"relative"},children:[e.jsx(U,{ref:g,inputClassName:"name-token-input white",inputCustomStyle:{paddingLeft:"10px",fontSize:"14px",paddingRight:"80px"},wrapperCustomStyle:{width:"100%",border:"1px solid var(--text-faded)",borderRadius:"var(--corner-radius)"},showValidationIcon:!0,showValidationOutline:!0,showValidationChecklist:!0,validationListStyle:{display:"none"},value:i,setValue:a=>b(a),catchInvalidInput:!1,maxCharLength:E,customPattern:q,validationPredicates:{[P.UNDERNAME]:{fn:a=>ee(a)},"Dashes and Underscores cannot be leading or trailing":{fn:a=>te(a)}}},"undername"),e.jsxs("span",{className:"flex flex-row grey",style:{position:"absolute",top:"0px",bottom:"0px",right:i.length?"35px":"10px",width:"fit-content"},children:[i.length," / ",E]})]}),m(i,j).length?e.jsx(Ce,{text:e.jsxs("span",{children:["This ANT has"," ",e.jsx(ae,{title:e.jsx("div",{className:"flex flex-column",style:{padding:"5px",gap:"5px",boxSizing:"border-box"},children:m(i,j).map(a=>e.jsx("span",{children:a},a))}),color:"var(--card-bg)",placement:"top",showArrow:!0,children:e.jsxs("span",{className:"underline bold",children:[m(i,j).length," ","name",m(i,j).length>1?"s":""]})})," ","that will not support this undername as it is over their supported length."]})}):e.jsx(e.Fragment,{})]}),e.jsxs("div",{className:"flex flex-column",style:{gap:"15px"},children:[e.jsx("span",{className:"grey",children:"Target ID:"}),e.jsx(U,{ref:x,inputClassName:"name-token-input white",inputCustomStyle:{paddingLeft:"10px",fontSize:"14px",paddingRight:"40px"},wrapperCustomStyle:{position:"relative",border:"1px solid var(--text-faded)",borderRadius:"var(--corner-radius)"},showValidationIcon:!0,showValidationOutline:!0,showValidationChecklist:!0,validationListStyle:{display:"none"},maxCharLength:43,value:p,setValue:S,catchInvalidInput:!0,customPattern:se,validationPredicates:{[P.ARWEAVE_ID]:{fn:async a=>{if(!H(a))throw new Error("Invalid Arweave ID");return!0}}}},"targetId")]}),e.jsxs("div",{className:"flex flex-column",style:{gap:"15px"},children:[e.jsx("span",{className:"grey",children:"TTL:"}),e.jsx(U,{ref:h,inputClassName:"name-token-input white",inputCustomStyle:{paddingLeft:"10px",fontSize:"14px"},wrapperCustomStyle:{position:"relative",border:"1px solid var(--text-faded)",borderRadius:"var(--corner-radius)",maxWidth:"130px"},showValidationIcon:!0,showValidationOutline:!0,showValidationChecklist:!0,type:"number",minNumber:M,maxNumber:k,validationListStyle:{display:"none"},maxCharLength:k.toString().length,value:y,setValue:a=>C(+a),catchInvalidInput:!0,customPattern:new RegExp(`^[0-9]{1,${k.toString().length}}$`),validationPredicates:{[P.VALID_TTL]:{fn:a=>ne(+a)}}},"ttlSeconds")]})]})})}),onCancel:o,onClose:o,onNext:H(p)&&re(i)&&y>=M&&y<=k?()=>L():void 0,footer:e.jsx("div",{className:"flex"}),nextText:"Next",cancelText:"Cancel"})})}const Re=we();function X(r,o){const l=[];return o.forEach(t=>{let u=!1;Object.entries(t).forEach(([,x])=>{var h,g;typeof x=="object"&&x!==null?X(r,[x]).length>0&&(u=!0):(g=(h=x==null?void 0:x.toString())==null?void 0:h.toLowerCase())!=null&&g.includes(r.toLowerCase())&&(u=!0)}),u&&l.push(t)}),l}const Ae=({undernames:r,arnsDomain:o,antId:l,ownershipStatus:t,filter:u,refresh:x,isLoading:h})=>{const[{gateway:g}]=ie(),[{wallet:i,walletAddress:b}]=G(),[,p]=le(),[S,y]=oe(),[C,j]=n.useState([]),[R,E]=n.useState([]),[A,w]=n.useState(),[L,m]=n.useState(),[a,d]=n.useState(),[v,N]=n.useState();async function V({payload:s,workflowName:c,processId:f}){try{if(!f)throw new Error("Unable to interact with ANT contract - missing ID.");if(!(i!=null&&i.arconnectSigner)||!b)throw new Error("Unable to interact with ANT contract - missing signer.");const{id:I}=await ye({processId:f,payload:s,workflowName:c,signer:i==null?void 0:i.arconnectSigner,owner:b==null?void 0:b.toString(),dispatch:p});_.emit("success",{name:"Manage Undernames",message:e.jsxs("span",{className:"flex flex-row whitespace-nowrap",style:{gap:"10px"},children:[c," complete."," ",e.jsx(F,{id:new $(I),type:W.INTERACTION,shouldLink:!0,characterCount:8})]})}),x&&x()}catch(I){_.emit("error",I)}finally{m(void 0),d(void 0)}}n.useEffect(()=>{if(r){const s=[];Object.entries(r).filter(([c])=>c!=="@").map(([c,f])=>{const I={undername:c,targetId:f.transactionId,ttlSeconds:f.ttlSeconds,action:e.jsxs("span",{className:"flex flex-row justify-end pr-3",style:{gap:"15px"},children:[e.jsx("button",{className:"fill-grey hover:fill-white",onClick:()=>{N(c),w(D.EDIT)},children:e.jsx(ce,{width:"16px",height:"16px",fill:"inherit"})}),e.jsx("button",{className:"fill-grey hover:fill-white",onClick:()=>{N(c),w(D.REMOVE),m({subDomain:c}),d(T.REMOVE_RECORD),p({type:"setWorkflowName",payload:T.REMOVE_RECORD})},children:e.jsx(Ee,{width:"16px",height:"16px",fill:"inherit"})})]})};s.push(I)}),j(s)}(!r||!Object.keys(r).length)&&j([])},[r]),n.useEffect(()=>{E(u?X(u,C):[])},[u,C]);const Z=["undername","targetId","ttlSeconds","action"].map(s=>Re.accessor(s,{id:s,header:s=="action"?"":s=="targetId"?"Target ID":s=="ttlSeconds"?"TTL Seconds":de(s),sortDescFirst:!0,cell:({row:c})=>{const f=c.getValue(s);if(!f)return"";switch(s){case"undername":return e.jsx(ue,{tooltipOverrides:{overlayClassName:"w-fit",overlayInnerStyle:{width:"fit-content"}},message:e.jsx("span",{className:"w-fit whitespace-nowrap text-primary",children:f}),icon:e.jsxs(xe,{className:"link gap-2 items-center",to:`https://${f}_${o}.${g}`,target:"_blank",children:[z(f,12)," ",e.jsx(he,{width:"12px",height:"12px",fill:"var(--text-white)"})]})});case"targetId":return e.jsx(F,{id:f,shouldLink:!0,characterCount:8,type:W.TRANSACTION});default:return f}}}));return e.jsxs("div",{children:[e.jsx(fe,{columns:Z,data:h?[]:R.length?R:C.length?C:[],isLoading:!1,noDataFoundText:h?e.jsxs("span",{className:"h-fit flex flex-col text-white w-full items-center p-5 justify-center",children:[e.jsx(pe,{animationData:me,loop:!0,className:"h-[100px]"}),e.jsx("span",{children:"Loading Undernames..."})]}):e.jsx("span",{className:"h-20 flex w-full items-center justify-center",children:"No Undernames Found"}),defaultSortingState:{id:"undername",desc:!0},tableClass:"bg-background border-[1px] border-dark-grey rounded border-collapse",rowClass:s=>{const c="*:pl-4";return(s==null?void 0:s.row)!==void 0?"hover:bg-primary-thin border-b-[1px] border-dark-grey "+c:(s==null?void 0:s.headerGroup)!==void 0?c+" border-b-[1px] border-dark-grey":"border-t-[1px] border-dark-grey "+c},addOnAfterTable:t===void 0?e.jsx(e.Fragment,{}):e.jsx("div",{className:"w-full flex flex-row text-primary font-semibold rounded-b-md border-b-[1px] border-x-[1px] border-dark-grey",children:e.jsxs("button",{className:"flex flex-row w-full justify-start items-center p-3 rounded-b-md bg-background hover:bg-primary-gradient text-primary hover:text-primary fill-primary hover:fill-black transition-all",style:{gap:"10px"},onClick:()=>w(D.CREATE),children:[e.jsx(Ie,{width:"20px",height:"20px",className:"text-primary fill-black"}),"Add Undername"]})}),paginationConfig:{pageSize:8}}),A==D.CREATE&&l&&t?e.jsx(De,{closeModal:()=>{y({...S,modal:void 0}),w(void 0)},payloadCallback:s=>{m(s),d(T.SET_RECORD),p({type:"setWorkflowName",payload:T.SET_RECORD}),w(void 0)},antId:l}):e.jsx(e.Fragment,{children:" "}),A===D.EDIT&&v&&t&&e.jsx(ge,{antId:new $(l),undername:v,closeModal:()=>{N(void 0),w(void 0)},payloadCallback:s=>{m(s),d(T.EDIT_RECORD),p({type:"setWorkflowName",payload:T.EDIT_RECORD}),N(void 0),w(void 0)}}),l&&L&&a&&t?e.jsx(be,{interactionType:a,confirm:()=>V({payload:L,workflowName:a,processId:l}),cancel:()=>{m(void 0),d(void 0),N(void 0)}}):e.jsx(e.Fragment,{})]})};function _e(){var S;const r=ve(),{id:o,name:l}=Ne(),{data:t,isLoading:u,refetch:x}=Te({domain:l,antId:H(o)?o:void 0}),[{walletAddress:h}]=G(),[g,i]=n.useState(void 0),[b,p]=n.useState("");return n.useEffect(()=>{if(!o&&!l){_.emit("error",new Error("Missing ANT transaction ID.")),r("/manage/ants");return}t!=null&&t.owner&&(t!=null&&t.controllers)&&i(je(t==null?void 0:t.owner,t==null?void 0:t.controllers,h==null?void 0:h.toString()))},[o,l,t==null?void 0:t.owner,t==null?void 0:t.controllers,h,u]),e.jsx(e.Fragment,{children:e.jsx("div",{className:"px-[100px]",children:e.jsxs("div",{className:"flex-column",children:[e.jsx("div",{className:"flex flex-justify-between",children:e.jsx("div",{className:"flex flex-row",style:{justifyContent:"space-between"},children:e.jsx("h2",{className:"white text-[2rem] whitespace-nowrap",children:"Manage Undernames"})})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex w-full p-3 border-x-[1px] border-t-[1px] border-dark-grey rounded-t-[5px] relative",children:[e.jsx(Se,{width:"18px",height:"18px",className:"fill-white absolute top-[13.5px] left-[11px]"}),e.jsx("input",{className:"pl-7 flex bg-background w-full focus:outline-none text-white placeholder:text-dark-grey",onChange:y=>p(y.target.value),value:b,placeholder:`Search undernames on '${l??z(o??"",10)}'`})]}),e.jsx(Ae,{undernames:(t==null?void 0:t.records)??{},arnsDomain:l,antId:(S=t==null?void 0:t.arnsRecord)==null?void 0:S.processId,ownershipStatus:g,isLoading:u,filter:b,refresh:()=>{u||x()}})]})]})})})}export{_e as default};
//# sourceMappingURL=Undernames-db4e72f9.js.map
