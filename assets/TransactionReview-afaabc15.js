import{by as m,be as T,c1 as A,c2 as k,b7 as L,aY as P,c3 as B,c4 as O,aU as N,c5 as F,j as t,a as M,aE as Y,aW as H,aV as z,b as G,aF as X,r as x,c6 as R,c7 as $,bz as q,aM as V,bF as J,c8 as K,c9 as Q}from"./index-32598a14.js";import{A as Z}from"./ANTCard-4342b32b.js";import{W as ee}from"./WarningCard-c3f6ea26.js";import{T as te}from"./TransactionCost-46638a4a.js";import{S as re}from"./StepProgressBar-cf96fe7b.js";import{g as D}from"./transaction-descriptions-8f3334af.js";import"./useBreakpoint-a916a4f6.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},r=new Error().stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="4d3dde93-dd0e-4096-a421-db8c5e23dec9",e._sentryDebugIdIdentifier="sentry-dbid-4d3dde93-dd0e-4096-a421-db8c5e23dec9")}catch{}})();async function se({payload:e,workflowName:r,owner:g,arioContract:o,processId:w,dispatch:l,signer:u,ao:y,scheduler:c=F}){let n;try{if(!o)throw new Error("ArIO provider is not defined");if(!u)throw new Error("signer is not defined");switch(l({type:"setSigning",payload:!0}),r){case m.BUY_RECORD:{const{name:i,type:a,years:p}=e;let d=e.processId;d==="atomic"&&(d=await k({state:e.state,signer:L(u),ao:y,scheduler:c,luaCodeTxId:P}),await B.init({signer:u,processId:O}).register({processId:d}).catch(S=>{N.emit("error",new Error(`Failed to register ANT process: ${S}. You may need to manually register the process`))}));const h=await o.buyRecord({name:T(i),type:a,years:p,processId:d});e.processId=d,n=h;break}case m.EXTEND_LEASE:n=await o.extendLease({name:T(e.name),years:e.years},A);break;case m.INCREASE_UNDERNAMES:n=await o.increaseUndernameLimit({name:T(e.name),increaseCount:e.qty},A);break;default:throw new Error(`Unsupported workflow name: ${r}`)}}catch(i){N.emit("error",i)}finally{l({type:"setSigning",payload:!1})}if(!n)throw new Error("Failed to dispatch ArIO interaction");const s={deployer:g.toString(),processId:w.toString(),id:n.id,type:"interaction",payload:e};return l({type:"setWorkflowName",payload:r}),l({type:"setInteractionResult",payload:s}),s}function _({workflowName:e,...r}){switch(e){case m.INCREASE_UNDERNAMES:case m.EXTEND_LEASE:return t.jsx("h1",{className:"flex white",style:{width:"100%",paddingBottom:"30px"},children:"Review"});case m.BUY_RECORD:return"Review your Purchase";default:return}}function pe(){const e=M(),[{ioTicker:r,arioContract:g,ioProcessId:o,aoNetwork:w,aoClient:l}]=Y(),[{arnsEmitter:u},y]=H(),[{walletAddress:c,wallet:n}]=z(),[{workflowName:s,interactionType:i,transactionData:a,interactionResult:p},d]=G(),h=X(),[E,S]=x.useState(),[f,j]=x.useState(R(i)),[I,v]=x.useState(_({workflowName:s})),[b,C]=x.useState(D({workflowName:s,ioTicker:r}));x.useEffect(()=>{if(!a&&!s){e("/");return}S($({interactionType:i,transactionData:{...a,deployedTransactionId:p==null?void 0:p.id}})),C(D({workflowName:s,ioTicker:r})),j(R(i)),v(_({workflowName:s}))},[a,p,s,i,c]);async function U(){try{if(!(g instanceof K))throw new Error("Wallet must be connected to dispatch transactions.");if(!a||!s)throw new Error("Transaction data is missing");if(!c)throw new Error("Wallet address is missing");await se({arioContract:g,workflowName:s,payload:a,owner:c,processId:o,dispatch:d,signer:n==null?void 0:n.arconnectSigner,ao:l,scheduler:w.SCHEDULER}),e("/transaction/complete")}catch(W){N.emit("error",W)}finally{c&&Q({emitter:u,dispatch:y,ioProcessId:o,walletAddress:c})}}return E?t.jsx("div",{className:"page",children:t.jsxs("div",{className:"flex flex-column center",style:h?{}:{gap:"0px",maxWidth:"900px",width:"100%"},children:[f&&f.length?t.jsx("div",{className:"flex flex-row",style:{marginBottom:"20px",width:"100%"},children:t.jsx(re,{stage:3,stages:f})}):t.jsx(t.Fragment,{}),typeof I=="string"?t.jsx("div",{className:"flex flex-row text-large white bold center",style:{height:"100%",padding:"50px 0px",borderTop:f!=null&&f.length?"solid 1px var(--text-faded)":""},children:I}):I,t.jsx(Z,{...E,bordered:!0,compact:!0}),t.jsx(te,{feeWrapperStyle:{alignItems:"center",justifyContent:"center",height:"100%"},fee:{[r]:a==null?void 0:a.interactionPrice},info:b&&t.jsx("div",{children:t.jsx(ee,{wrapperStyle:{padding:"10px",fontSize:"14px",alignItems:"center"},customIcon:t.jsx(V,{width:"20px",fill:"var(--accent)"}),text:b})})}),t.jsx("div",{className:"flex",style:{marginTop:20,width:"100%",justifyContent:"flex-end"},children:t.jsx(J,{onNext:()=>U(),onBack:()=>e(-1),backText:"Back",nextText:"Confirm"})})]})}):t.jsx(q,{loading:!0,message:"Loading transaction data..."})}export{pe as default};
//# sourceMappingURL=TransactionReview-afaabc15.js.map
